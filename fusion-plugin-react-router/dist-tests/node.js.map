{"version":3,"file":"node.js","sources":["../src/modules/Status.js","../src/modules/Redirect.js","../src/modules/ServerRouter.js","../src/modules/Route.js","../src/server.js","../src/modules/utils.js","../src/modules/ServerHistory.js","../src/__tests__/notfound.node.js","../src/modules/BrowserRouter.js","../src/browser.js","../src/plugin.js","../src/__tests__/plugin.js","../src/__tests__/redirect.node.js","../src/__tests__/route.node.js","../src/__tests__/status.node.js","../src/__tests__/switch.node.js"],"sourcesContent":["/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport * as React from 'react';\nimport PropTypes from 'prop-types';\n\ntype StatusPropsType = {\n  children: React.Node,\n  code?: string | number,\n};\ntype StatusContextType = {\n  router: {\n    staticContext: {\n      setCode: (code: number) => void,\n    },\n  },\n};\nexport class Status extends React.Component<StatusPropsType> {\n  constructor(props: StatusPropsType, context: StatusContextType) {\n    super(props, context);\n    const {\n      router: {staticContext},\n    } = context;\n    if (staticContext && staticContext.setCode) {\n      staticContext.setCode(parseInt(this.props.code, 10));\n    }\n  }\n\n  render() {\n    const children = this.props && this.props.children;\n    return Array.isArray(children) ? children[0] : children;\n  }\n}\n\nStatus.contextTypes = {\n  router: PropTypes.shape({\n    staticContext: PropTypes.object,\n  }),\n};\n\nexport const NotFound = <TProps: {children: React.Node}>(props: TProps) => (\n  <Status code={404}>{props.children}</Status>\n);\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport * as React from 'react';\nimport PropTypes from 'prop-types';\n\nimport type {LocationShapeType, RedirectType} from '../types.js';\n\ntype PropsType = {|\n  to: string | LocationShapeType,\n  push?: boolean,\n  from?: string,\n  exact?: boolean,\n  strict?: boolean,\n  code?: number | string,\n  children?: React.Node,\n|};\ntype ContextType = {\n  router: {\n    history: {\n      push: (el: string | LocationShapeType) => void,\n      replace: (el: string | LocationShapeType) => void,\n    },\n    staticContext?: {\n      setCode: (code: number) => void,\n      redirect: (el: string | LocationShapeType) => void,\n    },\n  },\n};\nexport class Redirect extends React.Component<PropsType> {\n  context: ContextType;\n\n  constructor(props: PropsType, context: ContextType) {\n    super(props, context);\n    if (this.isStatic(context)) this.perform();\n  }\n\n  static defaultProps = {\n    push: false,\n    code: 307,\n  };\n\n  componentDidMount() {\n    if (!this.isStatic()) this.perform();\n  }\n\n  isStatic(context: ContextType = this.context): boolean {\n    return !!(context && context.router && context.router.staticContext);\n  }\n\n  perform() {\n    const {history, staticContext} = this.context.router;\n    const {push, to, code} = this.props;\n\n    if (__NODE__ && staticContext) {\n      staticContext.setCode(parseInt(code, 10));\n      staticContext.redirect(to);\n      return;\n    }\n\n    if (push) {\n      history.push(to);\n    } else {\n      history.replace(to);\n    }\n  }\n\n  render() {\n    return null;\n  }\n}\n\nRedirect.contextTypes = {\n  router: PropTypes.shape({\n    history: PropTypes.shape({\n      push: PropTypes.func.isRequired,\n      replace: PropTypes.func.isRequired,\n    }).isRequired,\n    staticContext: PropTypes.object,\n  }).isRequired,\n};\n\n// Sanity type checking\n(Redirect: RedirectType);\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport * as React from 'react';\n\nimport {Router as RouterUntyped} from 'react-router-dom';\n\nimport type {RouterType, RouterHistoryType} from '../types.js';\n\nconst BaseRouter: RouterType = (RouterUntyped: any);\n\ntype PropsType = {\n  context?: any,\n  onRoute?: Function,\n  history: RouterHistoryType,\n  Provider?: RouterType,\n  basename?: string,\n  children?: React.Node,\n};\n\n/**\n * The public top-level API for a \"static\" <Router>, so-called because it\n * can't actually change the current location. Instead, it just records\n * location changes in a context object. Useful mainly in testing and\n * server-rendering scenarios.\n */\nclass ServerRouter extends React.Component<PropsType> {\n  static defaultProps = {\n    basename: '',\n    context: {},\n    Provider: BaseRouter,\n    onRoute: () => {},\n  };\n\n  getChildContext() {\n    return {\n      router: {\n        staticContext: this.props.context || {},\n      },\n      onRoute: (routeData: any) =>\n        this.props.onRoute && this.props.onRoute(routeData),\n    };\n  }\n\n  render() {\n    const {Provider, history, basename, children} = this.props;\n    if (!Provider) throw new Error('Missing Provider for Server Router');\n    return (\n      <Provider basename={basename} history={history}>\n        {children}\n      </Provider>\n    );\n  }\n}\n\nServerRouter.childContextTypes = {\n  router: () => {},\n  onRoute: () => {},\n};\n\nconst ServerRouterTyped: React.ComponentType<PropsType> = ServerRouter;\nexport {ServerRouterTyped as ServerRouter};\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport * as React from 'react';\nimport PropTypes from 'prop-types';\nimport {Route as ReactRouterRouteUntyped} from 'react-router-dom';\n\nimport type {RouteType} from '../types.js';\n\nconst ReactRouterRoute: RouteType = ReactRouterRouteUntyped;\n\nconst isEmptyChildren = (children: React.Node) =>\n  React.Children.count(children) === 0;\n\ntype PropsType = {\n  trackingId?: any,\n  component?: React.ComponentType<*>,\n  render?: (...props: any) => React.Node,\n  children?: ((routeProps: {match: MatchType}) => React.Node) | React.Node,\n};\ntype ContextType = {\n  onRoute: any,\n};\ntype MatchType = {\n  isExact: boolean,\n  path: string,\n  params: Object,\n  url: string,\n};\nfunction Route(props: PropsType, context: ContextType) {\n  const {trackingId, component, render, children, ...remainingProps} = props;\n\n  return (\n    <ReactRouterRoute\n      {...remainingProps}\n      // eslint-disable-next-line react/no-children-prop\n      children={(routeProps: {match: MatchType}) => {\n        const {match} = routeProps;\n        if (match && match.isExact) {\n          context.onRoute({\n            page: match.path,\n            title: trackingId || match.path,\n            params: match.params,\n          });\n        }\n\n        if (component)\n          return match ? React.createElement(component, routeProps) : null;\n\n        if (render) return match ? render(routeProps) : null;\n\n        if (typeof children === 'function') return children(routeProps);\n\n        if (children && !isEmptyChildren(children))\n          return React.Children.only(children);\n\n        return null;\n      }}\n    />\n  );\n}\n\nRoute.contextTypes = {\n  onRoute: PropTypes.func.isRequired,\n};\n\nRoute.displayName = 'FusionRoute';\n\nexport {Route};\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport {\n  BrowserRouter as BrowserRouterUntyped,\n  HashRouter as HashRouterUntyped,\n  Link as LinkUntyped,\n  MemoryRouter as MemoryRouterUntyped,\n  NavLink as NavLinkUntyped,\n  Prompt as PromptUntyped,\n  Router as _Router,\n  Switch as SwitchUntyped,\n  matchPath as matchPathUntyped,\n  withRouter as withRouterUntyped,\n} from 'react-router-dom';\n\nimport {Status, NotFound} from './modules/Status';\nimport {Redirect} from './modules/Redirect';\nimport {ServerRouter as Router} from './modules/ServerRouter';\nimport {Route} from './modules/Route';\n\nimport type {\n  BrowserRouterType,\n  HashRouterType,\n  LinkType,\n  MemoryRouterType,\n  NavLinkType,\n  PromptType,\n  SwitchType,\n  matchPathType,\n  withRouterType,\n} from './types.js';\n\n/**\n * Cast each of these imports from react-router-dom to a copied-version of their\n * types.  This is necessary as the libdef defined types will not be accessible to\n * consumers of this package.\n */\nconst BrowserRouter: BrowserRouterType = BrowserRouterUntyped;\nconst HashRouter: HashRouterType = HashRouterUntyped;\nconst Link: LinkType = LinkUntyped;\nconst MemoryRouter: MemoryRouterType = MemoryRouterUntyped;\nconst NavLink: NavLinkType = NavLinkUntyped;\nconst Prompt: PromptType = PromptUntyped;\nconst Switch: SwitchType = SwitchUntyped;\nconst matchPath: matchPathType = matchPathUntyped;\nconst withRouter: withRouterType = withRouterUntyped;\n\nexport {\n  BrowserRouter,\n  HashRouter,\n  Link,\n  MemoryRouter,\n  NavLink,\n  Prompt,\n  _Router,\n  Switch,\n  matchPath,\n  withRouter,\n  Status,\n  NotFound,\n  Redirect,\n  Router,\n  Route,\n};\n","// @flow\nimport type {LocationType} from '../types';\n\nconst addLeadingSlash = path => (path.charAt(0) === '/' ? path : '/' + path);\n\nexport const addRoutePrefix = (\n  location: string | LocationType,\n  prefix: string\n): string | LocationType => {\n  if (!prefix) return location;\n  if (typeof location === 'string') {\n    return `${prefix}${addLeadingSlash(location)}`;\n  } else {\n    return {\n      ...location,\n      pathname: `${prefix}${addLeadingSlash(location.pathname)}`,\n    };\n  }\n};\n\nexport const removeRoutePrefix = (\n  location: string | LocationType,\n  prefix: string\n): string | LocationType => {\n  if (!prefix) return location;\n  const pathname = typeof location === 'string' ? location : location.pathname;\n  const hasPrefix = (pathname + '/').indexOf(prefix + '/') === 0;\n  const unprefixedPathname = pathname.slice(prefix.length);\n  const relativePathname = hasPrefix ? unprefixedPathname : pathname;\n\n  if (typeof location === 'string') {\n    return relativePathname;\n  } else {\n    return {\n      ...location,\n      pathname: relativePathname,\n    };\n  }\n};\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport {createPath, parsePath} from 'history';\n\nimport {addRoutePrefix, removeRoutePrefix} from './utils.js';\nimport type {RouterHistoryType, LocationType} from '../types.js';\n\nconst createLocation = (\n  path: string | LocationType,\n  prefix: string\n): LocationType => {\n  const unprefixedPath = removeRoutePrefix(path, prefix);\n  return parsePath(unprefixedPath);\n};\n\nconst createPrefixedURL = (\n  location: string | LocationType,\n  prefix: string\n): string | LocationType => {\n  if (typeof location === 'string') {\n    return addRoutePrefix(location, prefix);\n  } else {\n    return createPath(addRoutePrefix(location, prefix));\n  }\n};\n\nconst createURL = (\n  location: string | LocationType,\n  prefix: string\n): string | LocationType => {\n  if (typeof location === 'string') {\n    return removeRoutePrefix(location, prefix);\n  } else {\n    return createPath(removeRoutePrefix(location, prefix));\n  }\n};\n\nconst staticHandler = methodName => () => {\n  throw new Error(`You cannot ${methodName} with server side <Router>`);\n};\n\nconst noop = () => {};\n\ntype ContextType = {\n  action: ?string,\n  location: any,\n  url: ?string,\n};\n\nexport function createServerHistory(\n  basename: string,\n  context: ContextType,\n  location: string | LocationType\n): RouterHistoryType {\n  function createHref(location: string | LocationType): string | LocationType {\n    return createPrefixedURL(location, basename);\n  }\n  function push(path: string) {\n    context.action = 'PUSH';\n    context.location = createLocation(path, basename);\n    const url = createURL(path, basename);\n    if (typeof url === 'string') {\n      context.url = url;\n    }\n  }\n\n  function replace(path: string) {\n    context.action = 'REPLACE';\n    context.location = createLocation(path, basename);\n    const url = createURL(path, basename);\n    if (typeof url === 'string') {\n      context.url = url;\n    }\n  }\n  const history = {\n    length: 0,\n    createHref,\n    action: 'POP',\n    location: createLocation(location, basename),\n    push,\n    replace,\n    go: staticHandler('go'),\n    goBack: staticHandler('back'),\n    goForward: staticHandler('forward'),\n    listen: () => noop,\n  };\n  return (history: any);\n}\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport test from 'tape-cup';\nimport React from 'react';\n\nimport {renderToString as render} from 'react-dom/server';\n\nimport {Router, Route, NotFound} from '../server.js';\nimport {createServerHistory} from '../modules/ServerHistory.js';\n\ntest('sets code', t => {\n  const Hello = () => (\n    <NotFound>\n      <div>Hello</div>\n    </NotFound>\n  );\n  const state = {code: 0};\n  const ctx = {\n    action: null,\n    location: null,\n    url: null,\n    setCode(code: number) {\n      state.code = code;\n    },\n  };\n  const history = createServerHistory('/', ctx, '/');\n  const el = (\n    <Router history={history} context={ctx}>\n      <Route component={Hello} />\n    </Router>\n  );\n  t.ok(/Hello/.test(render(el)), 'matches');\n  t.equals(state.code, 404, 'sets code');\n  t.end();\n});\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport * as React from 'react';\nimport PropTypes from 'prop-types';\nimport {Router as BaseRouterUntyped} from 'react-router-dom';\n\nimport type {RouterType, RouterHistoryType} from '../types.js';\n\nexport {Status, NotFound} from './Status.js';\nexport {Redirect} from './Redirect.js';\n\nconst BaseRouter: RouterType = (BaseRouterUntyped: any);\n\ntype PropsType = {|\n  context?: any,\n  onRoute?: Function,\n  history: RouterHistoryType,\n  Provider?: RouterType,\n  basename?: string,\n  children?: React.Node,\n|};\ntype ContextType = {\n  __IS_PREPARE__: boolean,\n};\nclass BrowserRouter extends React.Component<PropsType> {\n  lastTitle: ?string;\n  context: ContextType;\n\n  static defaultProps = {\n    onRoute: () => {},\n    Provider: BaseRouter,\n  };\n\n  constructor(props: PropsType, context: ContextType) {\n    super(props, context);\n    this.lastTitle = null;\n  }\n\n  getChildContext() {\n    const {__IS_PREPARE__} = this.context;\n    return {\n      onRoute: (routeData: any) => {\n        if (routeData.title !== this.lastTitle && !__IS_PREPARE__) {\n          this.lastTitle = routeData.title;\n          this.props.onRoute && this.props.onRoute(routeData);\n        }\n      },\n    };\n  }\n\n  render() {\n    const {Provider, history, basename} = this.props;\n    if (!Provider) throw new Error('Missing Provider for Browser Router');\n    return (\n      <Provider basename={basename} history={history}>\n        {this.props.children}\n      </Provider>\n    );\n  }\n}\n\nBrowserRouter.propTypes = {\n  children: PropTypes.node,\n  onRoute: PropTypes.func,\n  history: PropTypes.object,\n  Provider: PropTypes.any,\n  basename: PropTypes.string,\n};\n\nBrowserRouter.contextTypes = {\n  __IS_PREPARE__: PropTypes.bool,\n};\n\nBrowserRouter.childContextTypes = {\n  onRoute: PropTypes.func.isRequired,\n};\n\nconst BrowserRouterTyped: React.ComponentType<PropsType> = BrowserRouter;\nexport {BrowserRouterTyped as Router};\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport {\n  BrowserRouter as BrowserRouterUntyped,\n  HashRouter as HashRouterUntyped,\n  Link as LinkUntyped,\n  MemoryRouter as MemoryRouterUntyped,\n  NavLink as NavLinkUntyped,\n  Prompt as PromptUntyped,\n  StaticRouter as StaticRouterUntyped,\n  Switch as SwitchUntyped,\n  matchPath as matchPathUntyped,\n  withRouter as withRouterUntyped,\n} from 'react-router-dom';\n\nimport {Status, NotFound} from './modules/Status';\nimport {Redirect} from './modules/Redirect';\nimport {Router} from './modules/BrowserRouter';\nimport {Route} from './modules/Route';\n\nimport type {\n  BrowserRouterType,\n  HashRouterType,\n  LinkType,\n  MemoryRouterType,\n  NavLinkType,\n  PromptType,\n  StaticRouterType,\n  SwitchType,\n  matchPathType,\n  withRouterType,\n} from './types.js';\n\n/**\n * Cast each of these imports from react-router-dom to a copied-version of their\n * types.  This is necessary as the libdef defined types will not be accessible to\n * consumers of this package.\n */\nconst BrowserRouter: BrowserRouterType = BrowserRouterUntyped;\nconst HashRouter: HashRouterType = HashRouterUntyped;\nconst Link: LinkType = LinkUntyped;\nconst MemoryRouter: MemoryRouterType = MemoryRouterUntyped;\nconst NavLink: NavLinkType = NavLinkUntyped;\nconst Prompt: PromptType = PromptUntyped;\nconst StaticRouter: StaticRouterType = StaticRouterUntyped;\nconst Switch: SwitchType = SwitchUntyped;\nconst matchPath: matchPathType = matchPathUntyped;\nconst withRouter: withRouterType = withRouterUntyped;\n\nexport {\n  BrowserRouter,\n  HashRouter,\n  Link,\n  MemoryRouter,\n  NavLink,\n  Prompt,\n  StaticRouter,\n  Switch,\n  matchPath,\n  withRouter,\n  Status,\n  NotFound,\n  Redirect,\n  Router,\n  Route,\n};\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport * as React from 'react';\nimport {Router as DefaultProvider} from 'react-router-dom';\nimport createBrowserHistory from 'history/createBrowserHistory';\n\nimport {UniversalEventsToken} from 'fusion-plugin-universal-events';\nimport {createPlugin, createToken, html, unescape, memoize} from 'fusion-core';\nimport type {Token, Context, FusionPlugin} from 'fusion-core';\n\nimport {Router as ServerRouter} from './server.js';\nimport {Router as BrowserRouter} from './browser.js';\nimport {createServerHistory} from './modules/ServerHistory.js';\nimport {addRoutePrefix} from './modules/utils.js';\nimport type {RouterHistoryType} from './types.js';\n\ntype ProviderPropsType = {\n  history: RouterHistoryType,\n  basename?: string,\n  children?: React.Node,\n};\n\ntype HistoryWrapperType = {\n  from: (\n    ctx: Context\n  ) => {\n    history: RouterHistoryType,\n  },\n};\n\nexport const RouterProviderToken: Token<\n  React.ComponentType<ProviderPropsType>\n> = createToken('RouterProvider');\n\nexport const RouterToken: Token<HistoryWrapperType> = createToken('Router');\n\nconst Router = __NODE__ ? ServerRouter : BrowserRouter;\n\ntype PluginDepsType = {\n  emitter: typeof UniversalEventsToken.optional,\n  Provider: typeof RouterProviderToken.optional,\n};\n\nconst plugin: FusionPlugin<PluginDepsType, HistoryWrapperType> = createPlugin({\n  deps: {\n    emitter: UniversalEventsToken.optional,\n    Provider: RouterProviderToken.optional,\n  },\n  middleware: ({emitter, Provider = DefaultProvider}, self) => {\n    return async (ctx, next) => {\n      const prefix = ctx.prefix || '';\n      if (!ctx.element) {\n        return next();\n      }\n      const myAPI = self.from(ctx);\n      if (__NODE__) {\n        let pageData = {\n          title: ctx.path,\n          page: ctx.path,\n        };\n        const context = {\n          action: null,\n          location: null,\n          url: null,\n          setCode: code => {\n            ctx.status = code;\n          },\n          redirect: (url: string) => {\n            const toUrl = addRoutePrefix(url, prefix);\n            if (typeof toUrl === 'string') {\n              ctx.redirect(toUrl);\n            }\n          },\n        };\n        // Expose the history object\n        const history = createServerHistory(prefix, context, prefix + ctx.url);\n        myAPI.history = history;\n        ctx.element = (\n          <Router\n            history={history}\n            Provider={Provider}\n            onRoute={d => {\n              pageData = d;\n            }}\n            basename={prefix}\n            context={context}\n          >\n            {ctx.element}\n          </Router>\n        );\n        return next().then(() => {\n          ctx.template.body.push(\n            html`\n              <script id=\"__ROUTER_DATA__\" type=\"application/json\">\n                ${JSON.stringify(pageData)}\n              </script>\n            `\n          );\n\n          if (emitter) {\n            const scopedEmitter = emitter.from(ctx);\n            const emitTiming = type => timing => {\n              scopedEmitter.emit(type, {\n                title: pageData.title,\n                page: pageData.page,\n                status: ctx.status,\n                timing,\n              });\n            };\n            scopedEmitter.map(payload => {\n              if (payload && typeof payload === 'object') {\n                payload.__url__ = pageData.title;\n              }\n              return payload;\n            });\n            ctx.timing.end.then(timing => {\n              emitTiming('pageview:server')(timing);\n              ctx.timing.render.then(emitTiming('render:server'));\n            });\n          }\n        });\n      } else if (__BROWSER__) {\n        // TODO(#3): We should consider adding render/downstream/upstream timings for the browser\n        let pageData = {};\n        const element = document.getElementById('__ROUTER_DATA__');\n        if (element) {\n          pageData = JSON.parse(unescape(element.textContent));\n        }\n        emitter &&\n          emitter.map(payload => {\n            if (payload && typeof payload === 'object') {\n              payload.__url__ = pageData.title;\n              payload.__urlParams__ = pageData.params;\n            }\n            return payload;\n          });\n        // Expose the history object\n        const history = createBrowserHistory({basename: ctx.prefix});\n        myAPI.history = history;\n        ctx.element = (\n          <Router\n            history={history}\n            Provider={Provider}\n            basename={ctx.prefix}\n            onRoute={payload => {\n              pageData = payload;\n              emitter && emitter.emit('pageview:browser', payload);\n            }}\n          >\n            {ctx.element}\n          </Router>\n        );\n        return next();\n      }\n    };\n  },\n  provides() {\n    return {\n      from: memoize(() => {\n        const api: {history: RouterHistoryType} = ({\n          history: null,\n        }: any);\n        return api;\n      }),\n    };\n  },\n});\n\nexport default plugin;\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport React from 'react';\nimport {UniversalEventsToken} from 'fusion-plugin-universal-events';\nimport {createPlugin} from 'fusion-core';\nimport App from 'fusion-react';\nimport {getSimulator} from 'fusion-test-utils';\nimport {withRouter, Link} from 'react-router-dom';\nimport test from 'tape-cup';\nimport type {FusionPlugin} from 'fusion-core';\nimport {Route} from '../modules/Route';\nimport {Redirect} from '../modules/Redirect.js';\nimport RouterPlugin, {RouterProviderToken, RouterToken} from '../plugin';\n\nconst addRoutePrefix = (ctx, next) => {\n  // hack until we have better route prefix support in fusion-test-utils\n  ctx.prefix = '/test';\n  return next();\n};\n\nfunction getApp(el) {\n  const app = new App(el);\n  app.register(RouterToken, RouterPlugin);\n  return app;\n}\n\nfunction getPrefixApp(el) {\n  const app = new App(el);\n  app.middleware(addRoutePrefix);\n  app.register(RouterPlugin);\n  return app;\n}\n\nfunction cleanup() {\n  if (__BROWSER__) {\n    const root = document.getElementById('root');\n    if (root && document.body) {\n      document.body.removeChild(root);\n    }\n    const routerData = document.getElementById('__ROUTER_DATA__');\n    if (routerData && document.body) {\n      document.body.removeChild(routerData);\n    }\n  }\n}\n\nif (__NODE__) {\n  test('server side redirects', async t => {\n    const Hello = () => <div>Hello</div>;\n    const element = (\n      <div>\n        <Redirect from=\"/\" to=\"/lol\" />\n        <Route path=\"/lol\" component={Hello} />\n      </div>\n    );\n    const app = getApp(element);\n    const emitter: FusionPlugin<any, any> = createPlugin({\n      provides: () => ({\n        map() {},\n        emit() {},\n        from() {\n          return {\n            map() {},\n            emit() {},\n          };\n        },\n      }),\n    });\n    app.register(UniversalEventsToken, emitter);\n    const simulator = setup(app);\n    const ctx = await simulator.render('/');\n    t.equal(ctx.status, 307);\n    t.equal(ctx.res.getHeader('Location'), '/lol');\n    cleanup();\n    t.end();\n  });\n\n  test('server side redirects with prefix', async t => {\n    const Hello = () => <div>Hello</div>;\n    const element = (\n      <div>\n        <Redirect from=\"/\" to=\"/lol\" />\n        <Route path=\"/lol\" component={Hello} />\n      </div>\n    );\n    const app = getPrefixApp(element);\n    const simulator = setup(app);\n    const ctx = await simulator.render('/');\n    t.equal(ctx.status, 307);\n    t.equal(ctx.res.getHeader('Location'), '/test/lol');\n    cleanup();\n    t.end();\n  });\n}\n\ntest('events with trackingId', async t => {\n  const Hello = () => <div>Hello</div>;\n  const element = (\n    <div>\n      <Route path=\"/\" trackingId=\"home\" component={Hello} />\n      <Route path=\"/lol\" component={Hello} />\n    </div>\n  );\n  const app = getApp(element);\n  const UniversalEvents = getMockEvents({\n    t,\n    title: 'home',\n    page: '/',\n  });\n  app.register(UniversalEventsToken, UniversalEvents);\n  const simulator = setup(app);\n  await simulator.render('/');\n  cleanup();\n  t.end();\n});\n\ntest('events with no tracking id', async t => {\n  const Hello = () => <div>Hello</div>;\n  const element = (\n    <div>\n      <Route path=\"/\" component={Hello} />\n      <Route path=\"/lol\" component={Hello} />\n    </div>\n  );\n\n  const app = getApp(element);\n  const UniversalEvents = getMockEvents({\n    t,\n    title: '/',\n    page: '/',\n  });\n  app.register(UniversalEventsToken, UniversalEvents);\n  const simulator = setup(app);\n  await simulator.render('/');\n  cleanup();\n  t.end();\n});\n\ntest('Custom Provider', async t => {\n  const Hello = () => <div>Hello</div>;\n  const element = (\n    <div>\n      <Route path=\"/\" component={Hello} />\n      <Route path=\"/lol\" component={Hello} />\n    </div>\n  );\n\n  const app = getApp(element);\n  const UniversalEvents = getMockEvents({\n    t,\n    title: '/',\n    page: '/',\n  });\n  app.register(UniversalEventsToken, UniversalEvents);\n  app.register(RouterProviderToken, () => {\n    return <div id=\"custom-node\">CUSTOM PROVIDER RESULT</div>;\n  });\n  const simulator = setup(app);\n  const {rendered} = await simulator.render('/');\n  let result;\n  if (__BROWSER__) {\n    const node = document.getElementById('custom-node');\n    if (!node || !node.textContent) {\n      throw new Error('Could not find node.');\n    }\n    result = node && node.textContent;\n  } else {\n    result = rendered;\n  }\n\n  t.ok(result.includes('CUSTOM PROVIDER RESULT'), 'uses custom provider');\n  cleanup();\n  t.end();\n});\n\ntest('Router Providing History', async t => {\n  const Hello = () => <div>Hello</div>;\n  const element = (\n    <div>\n      <Route path=\"/\" component={Hello} />\n      <Route path=\"/lol\" component={Hello} />\n    </div>\n  );\n\n  const app = getApp(element);\n  const UniversalEvents = getMockEvents({\n    t,\n    title: '/',\n    page: '/',\n  });\n  app.register(UniversalEventsToken, UniversalEvents);\n  app.middleware(\n    {\n      router: RouterToken,\n    },\n    ({router}) => (ctx, next) => {\n      const {history} = router.from(ctx);\n      t.ok(history, 'provides a history object');\n      t.equal(\n        typeof history.push,\n        'function',\n        'provides correct history object'\n      );\n      t.equal(\n        typeof history.replace,\n        'function',\n        'provides correct history object'\n      );\n      return next();\n    }\n  );\n  const simulator = setup(app);\n  await simulator.render('/');\n  cleanup();\n  t.end();\n});\n\ntest('events with no tracking id and route prefix', async t => {\n  const Hello = () => <div>Hello</div>;\n  const element = (\n    <div>\n      <Route path=\"/\" component={Hello} />\n      <Route path=\"/lol\" component={Hello} />\n    </div>\n  );\n\n  const app = getPrefixApp(element);\n  const UniversalEvents = getMockEvents({\n    t,\n    title: '/',\n    page: '/',\n  });\n  app.register(UniversalEventsToken, UniversalEvents);\n  const simulator = setup(app);\n  await simulator.render('/');\n  cleanup();\n  t.end();\n});\n\ntest('events with no tracking id and deep path', async t => {\n  const Hello = () => <div>Hello</div>;\n  const NotHere = () => <div>NotHere</div>;\n  if (__BROWSER__) {\n    return t.end();\n  }\n  const element = (\n    <div>\n      <Route path=\"/user\" component={Hello} />\n      <Route path=\"/user/:uuid\" component={Hello} />\n      <Route path=\"/lol\" component={NotHere} />\n      <Link to=\"/lol\" />\n    </div>\n  );\n\n  const app = getApp(element);\n  const UniversalEvents = getMockEvents({\n    t,\n    title: '/user/:uuid',\n    page: '/user/:uuid',\n  });\n\n  app.register(UniversalEventsToken, UniversalEvents);\n  const simulator = setup(app);\n  const ctx = await simulator.render('/user/abcd');\n\n  t.ok(ctx.rendered.includes('href=\"/lol\"'), 'sets links correctly');\n  t.ok(\n    ctx.rendered.includes('<div>Hello</div><div>Hello</div>'),\n    'matches both user routes'\n  );\n  t.ok(!ctx.rendered.includes('NotHere'), 'does not match not here route');\n  cleanup();\n  t.end();\n});\n\ntest('events with no tracking id and deep path and route prefix', async t => {\n  const Hello = () => <div>Hello</div>;\n  const NotHere = () => <div>NotHere</div>;\n  if (__BROWSER__) {\n    return t.end();\n  }\n  const element = (\n    <div>\n      <Route path=\"/user\" component={Hello} />\n      <Route path=\"/user/:uuid\" component={Hello} />\n      <Route path=\"/lol\" component={NotHere} />\n      <Link to=\"/lol\" />\n    </div>\n  );\n\n  const app = getPrefixApp(element);\n  const UniversalEvents = getMockEvents({\n    t,\n    title: '/user/:uuid',\n    page: '/user/:uuid',\n  });\n\n  app.register(UniversalEventsToken, UniversalEvents);\n  const simulator = setup(app);\n  const ctx = await simulator.render('/user/abcd');\n  t.ok(ctx.rendered.includes('href=\"/test/lol\"'), 'sets links correctly');\n  t.ok(\n    ctx.rendered.includes('<div>Hello</div><div>Hello</div>'),\n    'matches both user routes'\n  );\n  t.ok(!ctx.rendered.includes('NotHere'), 'does not match not here route');\n  cleanup();\n  t.end();\n});\n\ntest('without UniversalEventsToken', async t => {\n  const Hello = () => <div>Hello</div>;\n  const element = (\n    <div>\n      <Route path=\"/\" trackingId=\"home\" component={Hello} />\n    </div>\n  );\n  const app = getApp(element);\n  const simulator = setup(app);\n  const ctx = await simulator.render('/');\n  if (__NODE__) {\n    t.ok(ctx.rendered.includes('<div>Hello</div>'), 'matches route');\n  }\n  cleanup();\n  t.end();\n});\n\nif (__BROWSER__) {\n  test('mapping events in browser', async t => {\n    const Home = withRouter(({location, history}) => {\n      if (location.pathname === '/') {\n        setTimeout(() => {\n          history.push('/user/1234');\n        }, 50);\n      }\n      // add some nested routes\n      return (\n        <div>\n          <Route path=\"/\" component={Hello} />\n        </div>\n      );\n    });\n    const User = () => {\n      // add some nested routes\n      return (\n        <div>\n          <Route path=\"/\" component={Hello} />\n          <Route path=\"/user/:uuid\" component={Hello} />\n        </div>\n      );\n    };\n    const Hello = () => {\n      return <div>Hello</div>;\n    };\n    const element = (\n      <div>\n        <Route path=\"/\" component={Home} />\n        <Route path=\"/user\" component={User} />\n      </div>\n    );\n    const app = getApp(element);\n    const expectedPayloads = [\n      {page: '/', params: {}, title: '/'},\n      {page: '/user/:uuid', params: {uuid: '1234'}, title: '/user/:uuid'},\n    ];\n    let mapper;\n    const UniversalEvents: FusionPlugin<any, any> = createPlugin({\n      provides: () => ({\n        map(m) {\n          mapper = m;\n        },\n        emit(type, payload) {\n          const expected = expectedPayloads.shift();\n          t.deepLooseEqual(payload, expected);\n          const mapped = mapper({});\n          t.equal(mapped.__url__, expected.title);\n          t.deepEqual(mapped.__urlParams__, expected.params);\n          if (expectedPayloads.length === 0) {\n            cleanup();\n            t.end();\n          }\n        },\n      }),\n    });\n\n    app.register(UniversalEventsToken, UniversalEvents);\n    const simulator = setup(app);\n    await simulator.render('/');\n  });\n}\n\nfunction getMockEvents({\n  t,\n  title: expectedTitle,\n  page: expectedPage,\n}): FusionPlugin<any, any> {\n  const expected = __NODE__\n    ? ['pageview:server', 'render:server']\n    : ['pageview:browser'];\n  return createPlugin({\n    provides: () => ({\n      map(mapper) {\n        t.equal(typeof mapper, 'function');\n      },\n      emit(type, {title, page}) {\n        if (__NODE__) {\n          throw new Error('fail');\n        }\n        t.equal(type, expected.shift(), 'emits with the correct type');\n        t.equal(title, expectedTitle, 'correct title');\n        t.equal(page, expectedPage, 'correct page');\n      },\n      from(ctx) {\n        t.ok(ctx, 'emits from scoped emitter');\n        return {\n          map() {},\n          emit(type, {title, page, status, timing}) {\n            t.equal(type, expected.shift(), 'emits with the correct type');\n            t.equal(title, expectedTitle, 'correct title');\n            t.equal(page, expectedPage, 'correct page');\n            t.equal(status, 200, 'emits status code');\n            t.equal(typeof timing, 'number', 'emits with the correct value');\n          },\n        };\n      },\n    }),\n  });\n}\n\nfunction setup(app, pageData = {title: '/', page: '/'}) {\n  if (__BROWSER__) {\n    const el = document.createElement('script');\n    el.setAttribute('type', 'application/json');\n    el.setAttribute('id', '__ROUTER_DATA__');\n    const textNode = document.createTextNode(JSON.stringify(pageData));\n    el.appendChild(textNode);\n    document.body && document.body.appendChild(el);\n    const rootEl = document.createElement('div');\n    rootEl.setAttribute('id', 'root');\n    document.body && document.body.appendChild(rootEl);\n  }\n  const simulator = getSimulator(app);\n  return simulator;\n}\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport test from 'tape-cup';\nimport React from 'react';\nimport {renderToString as render} from 'react-dom/server';\nimport {Router, Route, Redirect} from '../server';\nimport {createServerHistory} from '../modules/ServerHistory';\n\ntest('redirects to a new URL', t => {\n  const Hello = () => <div>Hello</div>;\n  const Moved = () => <Redirect to=\"/hello\" />;\n  let setCode = false;\n  let didRedirect = false;\n  const state = {\n    action: null,\n    location: null,\n    url: null,\n    setCode: code => {\n      t.equal(code, 307);\n      setCode = true;\n    },\n    redirect: to => {\n      t.equal(to, '/hello');\n      didRedirect = true;\n    },\n  };\n  const ctx = state;\n  const history = createServerHistory('/', ctx, '/');\n  const el = (\n    <Router history={history} context={ctx}>\n      <div>\n        <Route path=\"/\" component={Moved} />\n        <Route path=\"/hello\" component={Hello} />\n      </div>\n    </Router>\n  );\n  render(el);\n  t.ok(setCode);\n  t.ok(didRedirect);\n  t.end();\n});\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport test from 'tape-cup';\nimport React from 'react';\nimport {renderToString as render} from 'react-dom/server';\nimport {Router, Route} from '../server';\nimport {createServerHistory} from '../modules/ServerHistory';\n\ntest('matches as expected', t => {\n  const Hello = () => <div>Hello</div>;\n  const ctx = {\n    action: null,\n    location: null,\n    url: null,\n  };\n  const history = createServerHistory('/', ctx, '/');\n  const el = (\n    <Router history={history}>\n      <Route path=\"/\" component={Hello} />\n    </Router>\n  );\n  t.ok(/Hello/.test(render(el)), 'renders matched route in server');\n  t.end();\n});\ntest('misses as expected', t => {\n  const Hello = () => <div>Hello</div>;\n  const ctx = {\n    action: null,\n    location: null,\n    url: null,\n  };\n  const history = createServerHistory('/', ctx, '/foo');\n  const el = (\n    <Router history={history}>\n      <Route path=\"/bar\" component={Hello} />\n    </Router>\n  );\n  t.ok(!/Hello/.test(render(el)), 'does not render unmatched route');\n  t.end();\n});\ntest('support props.render', t => {\n  const ctx = {\n    action: null,\n    location: null,\n    url: null,\n  };\n  const history = createServerHistory('/', ctx, '/');\n  const Hello = () => <div>Hello</div>;\n  const el = (\n    <Router history={history}>\n      <Route path=\"/\" render={() => <Hello />} />\n    </Router>\n  );\n  t.doesNotThrow(\n    () => /Hello/.test(render(el)),\n    'does not throw when passing props.render'\n  );\n  t.ok(/Hello/.test(render(el)), 'renders matched route in server');\n  t.end();\n});\ntest('support props.children as render prop', t => {\n  const ctx = {\n    action: null,\n    location: null,\n    url: null,\n  };\n  const history = createServerHistory('/', ctx, '/');\n  const Hello = () => <div>Hello</div>;\n  /* eslint-disable react/no-children-prop */\n  const el = (\n    <Router history={history}>\n      <Route path=\"/\" children={() => <Hello />} />\n    </Router>\n  );\n  /* eslint-enable react/no-children-prop */\n  t.doesNotThrow(\n    () => /Hello/.test(render(el)),\n    'does not throw when passing props.children as function to <Route>'\n  );\n  t.ok(/Hello/.test(render(el)), 'renders matched route in server');\n  t.end();\n});\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport test from 'tape-cup';\nimport React from 'react';\nimport {renderToString as render} from 'react-dom/server';\nimport {Router, Route, Status} from '../server';\nimport {createServerHistory} from '../modules/ServerHistory';\n\ntest('sets code with static code', t => {\n  const Hello = () => (\n    <Status code=\"404\">\n      <div>Hello</div>\n    </Status>\n  );\n  const state = {code: 0};\n  const ctx = {\n    action: null,\n    location: null,\n    url: null,\n    setCode(code) {\n      state.code = code;\n    },\n  };\n  const history = createServerHistory('/', ctx, '/');\n  const el = (\n    <Router history={history} context={ctx}>\n      <Route component={Hello} />\n    </Router>\n  );\n  t.ok(/Hello/.test(render(el)), 'matches');\n  t.equals(state.code, 404, 'sets code');\n  t.end();\n});\n\ntest('sets code with numeric code', t => {\n  const Hello = () => (\n    <Status code={404}>\n      <div>Hello</div>\n    </Status>\n  );\n  const state = {code: 0};\n  const ctx = {\n    action: null,\n    location: null,\n    url: null,\n    setCode(code) {\n      state.code = code;\n    },\n  };\n  const history = createServerHistory('/', ctx, '/');\n  const el = (\n    <Router history={history} context={ctx}>\n      <Route component={Hello} />\n    </Router>\n  );\n  t.ok(/Hello/.test(render(el)), 'matches');\n  t.equals(state.code, 404, 'sets code');\n  t.end();\n});\n\ntest('sets code with string code', t => {\n  const Hello = () => (\n    <Status code={'404'}>\n      <div>Hello</div>\n    </Status>\n  );\n  const state = {code: 0};\n  const ctx = {\n    action: null,\n    location: null,\n    url: null,\n    setCode(code) {\n      state.code = code;\n    },\n  };\n  const history = createServerHistory('/', ctx, '/');\n  const el = (\n    <Router history={history} context={ctx}>\n      <Route component={Hello} />\n    </Router>\n  );\n  t.ok(/Hello/.test(render(el)), 'matches');\n  t.equals(state.code, 404, 'sets code');\n  t.end();\n});\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport test from 'tape-cup';\nimport React from 'react';\nimport {renderToString as render} from 'react-dom/server';\nimport {Router, Switch, Route} from '../server';\nimport {createServerHistory} from '../modules/ServerHistory';\n\ntest('matches as expected', t => {\n  const Hello = () => <div>Hello</div>;\n  const Hi = () => <div>Hi</div>;\n  const ctx = {\n    action: null,\n    location: null,\n    url: null,\n  };\n  const history = createServerHistory('/', ctx, '/');\n  const el = (\n    <Router history={history}>\n      <Switch>\n        <Route path=\"/\" component={Hello} />\n        <Route path=\"/\" component={Hi} />\n      </Switch>\n    </Router>\n  );\n  t.ok(/Hello/.test(render(el)), 'matches first');\n  t.ok(!/Hi/.test(render(el)), 'does not match second');\n  t.end();\n});\n"],"names":["Status","React","constructor","props","context","router","staticContext","setCode","parseInt","code","render","children","Array","isArray","contextTypes","PropTypes","shape","object","NotFound","Redirect","isStatic","perform","componentDidMount","history","push","to","redirect","replace","defaultProps","func","isRequired","BaseRouter","RouterUntyped","ServerRouter","getChildContext","onRoute","routeData","Provider","basename","Error","React.createElement","childContextTypes","ServerRouterTyped","ReactRouterRoute","ReactRouterRouteUntyped","isEmptyChildren","count","Route","trackingId","component","remainingProps","routeProps","match","isExact","page","path","title","params","only","displayName","BrowserRouter","BrowserRouterUntyped","HashRouter","HashRouterUntyped","Link","LinkUntyped","MemoryRouter","MemoryRouterUntyped","NavLink","NavLinkUntyped","Prompt","PromptUntyped","Switch","SwitchUntyped","matchPath","matchPathUntyped","withRouter","withRouterUntyped","addLeadingSlash","charAt","addRoutePrefix","location","prefix","pathname","removeRoutePrefix","hasPrefix","indexOf","unprefixedPathname","slice","length","relativePathname","createLocation","unprefixedPath","parsePath","createPrefixedURL","createPath","createURL","staticHandler","methodName","noop","createServerHistory","createHref","action","url","go","goBack","goForward","listen","test","t","Hello","state","ctx","el","Router","ok","equals","end","BaseRouterUntyped","lastTitle","__IS_PREPARE__","propTypes","node","any","string","bool","BrowserRouterTyped","StaticRouter","StaticRouterUntyped","RouterProviderToken","createToken","RouterToken","plugin","createPlugin","deps","emitter","UniversalEventsToken","optional","middleware","DefaultProvider","self","next","element","myAPI","from","pageData","status","toUrl","d","then","template","body","html","JSON","stringify","scopedEmitter","emitTiming","type","timing","emit","map","payload","__url__","provides","memoize","api","getApp","app","App","register","RouterPlugin","getPrefixApp","simulator","setup","equal","res","getHeader","cleanup","UniversalEvents","getMockEvents","rendered","result","includes","NotHere","expectedTitle","expectedPage","expected","mapper","shift","getSimulator","Moved","didRedirect","doesNotThrow","Hi"],"mappings":"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;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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"}
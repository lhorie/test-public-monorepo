{"version":3,"file":"node.js","sources":["../src/mock-context.js","../src/simulate.js","../src/index.js","../src/__tests__/index.js","../src/__tests__/index.node.js"],"sourcesContent":["/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\n/* eslint-env node */\n\nimport {parse} from 'url';\nimport type {Context} from 'fusion-core';\n\ndeclare var __BROWSER__: boolean;\n\ntype ContextOptions = {|\n  headers?: {[key: string]: string},\n  body?: mixed,\n  method?: string,\n|};\n\nconst defaultContextOptions: ContextOptions = {\n  headers: {},\n};\n\nexport function createRequestContext(\n  url: string,\n  options?: ContextOptions = defaultContextOptions\n): Context {\n  if (__BROWSER__) {\n    const parsedUrl = {...parse(url)};\n    const {path} = parsedUrl;\n    parsedUrl.path = parsedUrl.pathname;\n    //$FlowFixMe\n    parsedUrl.url = path;\n    //$FlowFixMe\n    return {parsedUrl};\n  }\n  const httpMocks = require('node-mocks-http');\n  const Stream = require('stream');\n  const Koa = require('koa');\n  let req = httpMocks.createRequest({url, ...options});\n  let res = httpMocks.createResponse();\n\n  /**\n   * Copied from https://github.com/koajs/koa/blob/master/test/helpers/context.js\n   * Copyright (c) 2016 Koa contributors\n   * MIT License\n   * https://github.com/koajs/koa/blob/master/LICENSE\n   */\n  const socket = new Stream.Duplex();\n  //$FlowFixMe\n  req = Object.assign({headers: {}, socket}, Stream.Readable.prototype, req);\n  //$FlowFixMe\n  res = Object.assign({_headers: {}, socket}, Stream.Writable.prototype, res, {\n    statusCode: 404,\n  });\n  req.socket.remoteAddress = req.socket.remoteAddress || '127.0.0.1';\n  res.getHeader = k => res._headers[k.toLowerCase()];\n  res.setHeader = (k, v) => (res._headers[k.toLowerCase()] = v);\n  res.removeHeader = k => delete res._headers[k.toLowerCase()];\n\n  // createContext is missing in Koa typings\n  const ctx = (new Koa(): any).createContext(req, res);\n\n  ctx.memoized = new Map();\n\n  if (options.body) {\n    ctx.request.body = options.body;\n  }\n\n  return ctx;\n}\n\nexport function createRenderContext(\n  url: string,\n  options?: ContextOptions = defaultContextOptions\n): Context {\n  // $FlowFixMe\n  return createRequestContext(url, {\n    ...options,\n    headers: {\n      accept: 'text/html',\n      ...(options.headers || {}),\n    },\n  });\n}\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n/* globals global */\n\nimport FusionApp, {compose} from 'fusion-core';\nimport type {Context} from 'fusion-core';\n\nimport {createRequestContext, createRenderContext} from './mock-context.js';\n\nexport const request = (app: FusionApp) => (\n  url: string,\n  options: * = {}\n): Promise<*> => {\n  if (__BROWSER__) {\n    throw new Error(\n      '[fusion-test-utils] Request api not support from the browser. Please use `render` instead'\n    );\n  }\n  const ctx = createRequestContext(url, options);\n  return simulate(app, ctx);\n};\n\nexport const render = (app: FusionApp) => (\n  url: string,\n  options: * = {}\n): Promise<*> => {\n  if (global.jsdom) {\n    if (!url.startsWith('/')) {\n      url = `/${url}`;\n    }\n    global.jsdom.reconfigure({\n      url: `http://localhost${url}`,\n    });\n  }\n  const ctx = createRenderContext(url, options);\n  return simulate(app, ctx);\n};\n\nexport default function simulate(app: FusionApp, ctx: Context): Promise<*> {\n  return compose(app.plugins)(ctx, () => Promise.resolve()).then(() => ctx);\n}\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport assert from 'assert';\n\nimport FusionApp, {createToken, createPlugin} from 'fusion-core';\nimport type {FusionPlugin, Token} from 'fusion-core';\n\n/* Note: as the Jest type definitions are declared globally and not as part of\n * a module, we must import the relevant types directly from the libdef file here\n * to avoid the invariant that all consumers must add the jest libdef to their\n * .flowconfig libs.\n */\nimport type {JestTestName, JestObjectType} from './flow/jest_v22.x.x.js';\nimport {render, request} from './simulate';\n\nexport {createRequestContext, createRenderContext} from './mock-context';\n\ndeclare var __BROWSER__: boolean;\n\ntype ExtractFusionAppReturnType = <R>((FusionApp) => R) => R;\nexport type Simulator = {\n  request: $Call<ExtractFusionAppReturnType, typeof request>,\n  render: $Call<ExtractFusionAppReturnType, typeof render>,\n  getService<T>(token: Token<T>): T,\n};\nexport function getSimulator(\n  app: FusionApp,\n  testPlugin?: FusionPlugin<*, *>\n): Simulator {\n  if (testPlugin) {\n    app.register(testPlugin);\n  }\n  app.resolve();\n\n  return {\n    request: request(app),\n    render: render(app),\n    // $FlowFixMe\n    getService: token => app.getService(token),\n  };\n}\n\nexport function getService<TDeps, TService>(\n  appCreator: () => FusionApp,\n  plugin: FusionPlugin<TDeps, TService>\n): TService {\n  const app = appCreator();\n  const token: Token<TService> = createToken('service-helper');\n\n  let extractedService = null;\n  app.register(token, plugin);\n  app.register(\n    createPlugin({\n      deps: {service: token},\n      provides: ({service}) => {\n        extractedService = service;\n      },\n    })\n  );\n  app.resolve();\n\n  if (!extractedService) {\n    throw new Error('Provided plugin does not export a service');\n  }\n\n  return extractedService;\n}\n\n// Export test runner functions from jest\ntype ExtractArgsReturnType<TArguments, TReturn> = <R>(\n  (implementation?: (...args: TArguments) => TReturn) => R\n) => R;\ntype JestFnType = $PropertyType<JestObjectType, 'fn'>;\n// eslint-disable-next-line flowtype/generic-spacing\ntype MockFunctionType<TArgs, TReturn> = (\n  ...args: TArgs\n) => $Call<ExtractArgsReturnType<TArgs, TReturn>, JestFnType>;\ntype MatchSnapshotType = (tree: mixed, snapshotName: ?string) => void;\ntype CallableAssertType = (\n  assert: typeof assert & {matchSnapshot: MatchSnapshotType}\n) => void | Promise<void>;\ntype TestType = (name: JestTestName, assert: CallableAssertType) => void;\n\n// eslint-disable-next-line import/no-mutable-exports\nlet mockFunction: MockFunctionType<*, *>, test: any;\n// $FlowFixMe\nif (typeof it !== 'undefined') {\n  // Surface snapshot testing\n  // $FlowFixMe\n  assert.matchSnapshot = (tree, snapshotName) =>\n    // $FlowFixMe\n    expect(tree).toMatchSnapshot(snapshotName);\n\n  /* eslint-env node, jest */\n  test = (description, callback, ...rest) =>\n    it(description, () => callback(assert), ...rest);\n  // $FlowFixMe\n  mockFunction = (...args) => jest.fn(...args);\n} else {\n  const notSupported = () => {\n    throw new Error('Canâ€™t import test() when not using the test-app target.');\n  };\n  test = notSupported;\n  mockFunction = notSupported;\n}\n\nconst mockFunctionExport = ((mockFunction: any): MockFunctionType<*, *>);\nconst testExport = ((test: any): TestType);\n\nexport {mockFunctionExport as mockFunction, testExport as test};\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport test from 'tape-cup';\nimport App, {createPlugin, createToken, memoize} from 'fusion-core';\nimport type {Token, FusionPlugin} from 'fusion-core';\n\nimport {getSimulator, getService, test as exportedTest} from '../index.js';\n\ntest('simulate render request', async t => {\n  const flags = {render: false};\n  const element = 'hi';\n  const renderFn = () => {\n    flags.render = true;\n  };\n  const app = new App(element, renderFn);\n  var testApp = getSimulator(app);\n  const ctx = await testApp.render('/');\n  t.ok(flags.render, 'triggered ssr');\n  t.ok(ctx.element, 'sets ctx.element');\n  t.end();\n});\n\ntest('simulate multi-render requests', async t => {\n  const counter = {renderCount: 0};\n  const renderFn = () => {\n    counter.renderCount++;\n  };\n  const app = new App('hello', renderFn);\n  var testApp = getSimulator(app);\n\n  for (var i = 1; i <= 5; i++) {\n    await testApp.render('/');\n    t.equal(counter.renderCount, i, `#${i} ssr render successful`);\n  }\n\n  t.end();\n});\n\ntest('simulate non-render request', async t => {\n  const flags = {render: false};\n  const element = 'hi';\n  const renderFn = () => {\n    flags.render = true;\n  };\n  const app = new App(element, renderFn);\n  const testApp = getSimulator(app);\n  if (__BROWSER__) {\n    try {\n      testApp.request('/');\n      t.fail('should have thrown');\n    } catch (e) {\n      t.ok(e, 'throws an error');\n    } finally {\n      t.end();\n    }\n  } else {\n    const ctx = await testApp.request('/');\n    t.notok(ctx.element, 'does not set ctx.element');\n    t.ok(!flags.render, 'did not trigger ssr');\n    t.end();\n  }\n});\n\ntest('use simulator with fixture and plugin dependencies', async t => {\n  // Dependency-less plugin\n  type MessageType = {\n    msg: string,\n  };\n  const msgProviderPluginToken: Token<MessageType> = createToken(\n    'MessageProviderPluginToken'\n  );\n  const msgProviderPlugin = createPlugin({\n    provides() {\n      return {msg: 'it works!'};\n    },\n  });\n  function getTestFixture() {\n    // Register plugins\n    const app = new App('hi', el => el);\n    app.register(msgProviderPluginToken, msgProviderPlugin);\n    return app;\n  }\n  const app = getTestFixture();\n\n  t.plan(3);\n  let testPlugin: FusionPlugin<*, *> = createPlugin({\n    deps: {msgProvider: msgProviderPluginToken},\n    provides(deps) {\n      t.ok(deps, 'some dependencies successfully resolved');\n      t.ok(deps.msgProvider, 'requested dependency successfully resolved');\n      const {msgProvider} = deps;\n      if (msgProviderPlugin.provides) {\n        t.equal(\n          msgProvider.msg,\n          msgProviderPlugin.provides().msg,\n          'dependency payload is correct'\n        );\n      }\n      return 'yay!';\n    },\n  });\n  getSimulator(app, testPlugin);\n\n  t.end();\n});\n\ntest('test throws when not using test-app', async t => {\n  try {\n    //$FlowFixMe\n    exportedTest();\n  } catch (e) {\n    t.ok(\n      e.message.includes('test-app'),\n      'throws an error about running test-app'\n    );\n    t.end();\n  }\n});\n\ntest('getService - returns service as expected, with no dependencies', async t => {\n  const simplePlugin = createPlugin({\n    provides() {\n      return {meaningOfLife: 42};\n    },\n  });\n\n  const service = getService(() => new App('hi', el => el), simplePlugin);\n  t.ok(service);\n  t.equal(service.meaningOfLife, 42);\n\n  t.end();\n});\n\ntest('getService - returns service as expected, with dependencies', async t => {\n  const meaningOfLifeToken = createToken('meaning-of-life-token');\n  const meaningOfLifePlugin = createPlugin({\n    provides() {\n      return 42;\n    },\n  });\n  const simplePlugin = createPlugin({\n    deps: {meaning: meaningOfLifeToken},\n    provides: ({meaning}) => {\n      return {meaningOfLife: meaning};\n    },\n  });\n\n  const service = getService(() => {\n    const app = new App('hi', el => el);\n    app.register(meaningOfLifeToken, meaningOfLifePlugin);\n    return app;\n  }, simplePlugin);\n  t.ok(service);\n  t.equal(service.meaningOfLife, 42);\n\n  t.end();\n});\n\ntest('getService - throws as expected due to missing dependency', async t => {\n  const meaningOfLifeToken = createToken('meaning-of-life-token');\n  const simplePlugin = createPlugin({\n    deps: {meaning: meaningOfLifeToken},\n    provides: ({meaning}) => {\n      return {meaningOfLife: meaning};\n    },\n  });\n  t.throws(() => getService(() => new App('hi', el => el), simplePlugin));\n  t.end();\n});\n\ntest('memoize helper', async t => {\n  const app = new App('hi', el => el);\n  app.register(\n    createPlugin({\n      provides: () => {\n        return {\n          from: memoize(ctx => {\n            return 5;\n          }),\n        };\n      },\n      middleware: (deps, self) => {\n        return (ctx, next) => {\n          t.equal(self.from(ctx), 5);\n          return next();\n        };\n      },\n    })\n  );\n  const sim = getSimulator(app);\n  await sim.render('/');\n  t.end();\n});\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n/* globals global */\n\nimport test from 'tape-cup';\nimport App from 'fusion-core';\n\nimport {\n  getSimulator,\n  createRequestContext,\n  createRenderContext,\n} from '../index.js';\n\ntest('jsdom', async t => {\n  let reconfigured = false;\n  global.jsdom = {\n    reconfigure: ({url}) => {\n      t.equal(url, 'http://localhost/test');\n      reconfigured = true;\n    },\n  };\n  const app = new App('el', () => 'hello');\n  await getSimulator(app).render('/test');\n  t.equal(reconfigured, true);\n  t.end();\n  delete global.jsdom;\n});\n\ntest('jsdom with empty string', async t => {\n  let reconfigured = false;\n  global.jsdom = {\n    reconfigure: ({url}) => {\n      t.equal(url, 'http://localhost/');\n      reconfigured = true;\n    },\n  };\n  const app = new App('el', () => 'hello');\n  await getSimulator(app).render('');\n  t.equal(reconfigured, true);\n  t.end();\n  delete global.jsdom;\n});\n\ntest('jsdom with /', async t => {\n  let reconfigured = false;\n  global.jsdom = {\n    reconfigure: ({url}) => {\n      t.equal(url, 'http://localhost/');\n      reconfigured = true;\n    },\n  };\n  const app = new App('el', () => 'hello');\n  await getSimulator(app).render('/');\n  t.equal(reconfigured, true);\n  t.end();\n  delete global.jsdom;\n});\n\ntest('status is 404 if ctx.body is never updated', async t => {\n  const app = new App('el', el => el);\n  const ctx = await getSimulator(app).request('/');\n  t.equals(ctx.status, 404, 'status defaults to 404');\n  t.end();\n});\n\ntest('status is 200 if ctx.body is updated in request', async t => {\n  const app = new App('el', el => el);\n  app.middleware((ctx, next) => {\n    ctx.body = {ok: 1};\n    return next();\n  });\n  const ctx = await getSimulator(app).request('/');\n  t.equals(ctx.status, 200, 'status defaults to 200');\n  t.end();\n});\n\ntest('status is set if ctx.status is updated in request', async t => {\n  const app = new App('el', () => 'hello');\n  app.middleware((ctx, next) => {\n    ctx.status = 500;\n    ctx.body = {error: 'error'};\n    return next();\n  });\n  const ctx = await getSimulator(app).render('/');\n  t.equals(ctx.status, 500, 'status is set');\n  t.end();\n});\n\ntest('status is 200 if ctx.body is updated in render', async t => {\n  const app = new App('el', () => 'hello');\n  const ctx = await getSimulator(app).render('/');\n  t.equals(ctx.status, 200, 'status defaults to 200');\n  t.end();\n});\n\ntest('status is set if ctx.status is updated in render', async t => {\n  const app = new App('el', () => 'hello');\n  app.middleware((ctx, next) => {\n    ctx.status = 500;\n    return next();\n  });\n  const ctx = await getSimulator(app).render('/');\n  t.equals(ctx.status, 500, 'status is set');\n  t.end();\n});\n\ntest('simulator accepts extra headers', async t => {\n  const app = new App('hi', () => {});\n  const simulator = getSimulator(app);\n\n  const ctx = await simulator.render('/', {\n    headers: {\n      'x-header': 'value',\n    },\n  });\n\n  t.equal(ctx.request.headers['x-header'], 'value');\n  t.end();\n});\n\ntest('body contains some message', async t => {\n  const app = new App('el', () => 'hello');\n  const ctx = await getSimulator(app).request('/_errors', {\n    body: {message: 'test'},\n  });\n  t.equals(ctx.status, 404, 'status is set');\n  t.deepEquals(ctx.request.body, {message: 'test'}, 'body is set');\n  t.end();\n});\n\ntest('createRequestContext', t => {\n  t.equal(createRequestContext('/').url, '/', 'url');\n  t.equal(createRequestContext('/test').url, '/test', 'url');\n  t.equal(createRequestContext('/', {method: 'POST'}).method, 'POST', 'method');\n  t.equal(\n    createRequestContext('/', {headers: {test: 'test'}}).headers.test,\n    'test',\n    'custom header'\n  );\n  t.equal(\n    createRequestContext('/', {body: 'test'}).request.body,\n    'test',\n    'body'\n  );\n  t.end();\n});\n\ntest('createRenderContext', t => {\n  t.equal(createRenderContext('/').url, '/', 'url');\n  t.equal(createRenderContext('/test').url, '/test', 'url');\n  t.equal(createRenderContext('/', {method: 'POST'}).method, 'POST', 'method');\n  t.equal(\n    createRenderContext('/', {headers: {test: 'test'}}).headers.test,\n    'test',\n    'custom header'\n  );\n  t.equal(\n    createRenderContext('/', {headers: {test: 'test'}}).headers.accept,\n    'text/html',\n    'default accept header'\n  );\n  t.equal(\n    createRenderContext('/').headers.accept,\n    'text/html',\n    'default accept header'\n  );\n  t.equal(\n    createRenderContext('/', {body: 'test'}).request.body,\n    'test',\n    'body'\n  );\n  t.end();\n});\n"],"names":["defaultContextOptions","headers","createRequestContext","url","options","httpMocks","require","Stream","Koa","req","createRequest","res","createResponse","socket","Duplex","Object","assign","Readable","prototype","_headers","Writable","statusCode","remoteAddress","getHeader","k","toLowerCase","setHeader","v","removeHeader","ctx","createContext","memoized","Map","body","request","createRenderContext","accept","app","simulate","render","global","jsdom","startsWith","reconfigure","compose","plugins","Promise","resolve","then","getSimulator","testPlugin","register","getService","token","appCreator","plugin","createToken","extractedService","createPlugin","deps","service","provides","Error","mockFunction","test","it","assert","matchSnapshot","tree","snapshotName","expect","toMatchSnapshot","description","callback","rest","args","jest","fn","notSupported","mockFunctionExport","testExport","t","flags","element","renderFn","App","testApp","ok","end","counter","renderCount","i","equal","notok","msgProviderPluginToken","msgProviderPlugin","msg","getTestFixture","el","plan","msgProvider","exportedTest","e","message","includes","simplePlugin","meaningOfLife","meaningOfLifeToken","meaningOfLifePlugin","meaning","throws","from","memoize","middleware","self","next","sim","reconfigured","equals","status","error","simulator","deepEquals","method"],"mappings":"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"}
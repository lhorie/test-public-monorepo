{"version":3,"file":"node.js","sources":["../src/create-plugin.js","../src/create-token.js","../src/tokens.js","../src/sanitization.js","../src/plugins/ssr.js","../src/base-app.js","../src/compose.js","../src/memoize.js","../src/plugins/timing.js","../src/plugins/server-renderer.js","../src/get-env.js","../src/plugins/server-context.js","../src/server-app.js","../src/virtual/index.js","../src/index.js","../src/__tests__/app-interface.js","../src/__tests__/app.node.js","../src/__tests__/test-helper.js","../src/__tests__/cleanup.js","../src/__tests__/compose.js","../src/__tests__/dependency-resolution.js","../src/__tests__/enhance.js","../src/__tests__/env.node.js","../src/__tests__/exports.js","../src/__tests__/index.node.js","../src/__tests__/memoize.js","../src/__tests__/render.js","../src/__tests__/sanitization.node.js","../src/__tests__/timing.js","../src/__tests__/virtual.js"],"sourcesContent":["/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport type {FusionPlugin} from './types.js';\n\n// eslint-disable-next-line flowtype/generic-spacing\ntype FusionPluginNoHidden<TDeps, TService> = $Diff<\n  FusionPlugin<TDeps, TService>,\n  {__plugin__: boolean, stack: string}\n>;\n\nexport function createPlugin<TDeps, TService>(\n  opts: $Exact<FusionPluginNoHidden<TDeps, TService>>\n): FusionPlugin<TDeps, TService> {\n  return {\n    __plugin__: true,\n    stack: new Error().stack,\n    ...opts,\n  };\n}\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport type {Token} from './types.js';\n\nexport const TokenType = Object.freeze({\n  Required: 0,\n  Optional: 1,\n});\nfunction Ref() {}\nexport class TokenImpl<TResolved> {\n  name: string;\n  ref: mixed;\n  type: $Values<typeof TokenType>;\n  optional: ?TokenImpl<TResolved>;\n  stacks: Array<{\n    type: 'token' | 'register' | 'enhance' | 'alias-from' | 'alias-to',\n    stack: string,\n  }>;\n\n  constructor(name: string, ref: mixed) {\n    this.name = name;\n    this.ref = ref || new Ref();\n    this.type = ref ? TokenType.Optional : TokenType.Required;\n    this.stacks = [{type: 'token', stack: new Error().stack}];\n    if (!ref) {\n      this.optional = new TokenImpl(name, this.ref);\n    }\n  }\n}\n\nexport function createToken<TResolvedType>(name: string): Token<TResolvedType> {\n  return ((new TokenImpl(name): any): Token<TResolvedType>);\n}\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport {createToken} from './create-token';\nimport type {\n  RenderType,\n  SSRDecider,\n  SSRBodyTemplate,\n  Context,\n} from './types.js';\nimport type {Server} from 'http';\n\nexport const RenderToken = createToken<RenderType>('RenderToken');\nexport const ElementToken = createToken<any>('ElementToken');\nexport const SSRDeciderToken = createToken<SSRDecider>('SSRDeciderToken');\nexport const HttpServerToken = createToken<Server>('HttpServerToken');\nexport const SSRBodyTemplateToken = createToken<SSRBodyTemplate>(\n  'SSRBodyTemplateToken'\n);\nexport const RoutePrefixToken = createToken<string>('RoutePrefixToken');\n\nexport type CriticalChunkIds = Set<number>;\n\nexport type CriticalChunkIdsService = {\n  from(ctx: Context): CriticalChunkIds,\n};\n\nexport const CriticalChunkIdsToken = createToken<CriticalChunkIdsService>(\n  'CriticalChunkIdsToken'\n);\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n/*\nWe never want developers to be able to write `ctx.template.body.push(`<div>${stuff}</div>`)`\nbecause that allows XSS attacks by default (e.g. if stuff === '<script>alert(1)</script>')\nInstead, they should use html`<div>{stuff}</div>` so interpolated data gets automatically escaped\nWe trust the markup outside of interpolation because it's code written by a developer with commit permissions,\nwhich can be audited via code reviews\n*/\n\nimport type {SanitizedHTMLWrapper} from './types.js';\n\n// eslint-disable-next-line import/no-mutable-exports\nlet html, dangerouslySetHTML, consumeSanitizedHTML, escape;\nif (__NODE__) {\n  const forbiddenChars = {\n    '<': '\\\\u003C',\n    '>': '\\\\u003E',\n    '\"': '\\\\u0022',\n    '/': '\\\\u002F',\n    '\\u2028': '\\\\u2028',\n    '\\u2029': '\\\\u2029',\n  };\n  const replaceForbidden = c => forbiddenChars[c];\n\n  const key = Symbol('sanitized html');\n  html = (\n    [head, ...rest]: Array<string>,\n    ...values: Array<string>\n  ): SanitizedHTMLWrapper => {\n    const obj = {};\n    Object.defineProperty(obj, key, {\n      enumerable: false,\n      configurable: false,\n      value: head + values.map((s, i) => escape(s) + rest[i]).join(''),\n    });\n    return obj;\n  };\n  dangerouslySetHTML = (str: string): Object => html([str]);\n  escape = (str: any): string => {\n    if (str && str[key]) return consumeSanitizedHTML(str);\n    return String(str).replace(/[<>\"/\\u2028\\u2029]/g, replaceForbidden);\n  };\n  consumeSanitizedHTML = (h: SanitizedHTMLWrapper): string => {\n    if (typeof h === 'string') {\n      throw new Error(`Unsanitized html. Use html\\`${h}\\``);\n    }\n    return h[key];\n  };\n}\nconst replaceEscaped = c => String.fromCodePoint(parseInt(c.slice(2), 16));\nconst unescape = (str: string): string => {\n  return str.replace(\n    /\\\\u003C|\\\\u003E|\\\\u0022|\\\\u002F|\\\\u2028|\\\\u2029/g,\n    replaceEscaped\n  );\n};\n\n// These types are necessary due to not having an assignment in the __BROWSER__ environment\nconst flowHtml = ((html: any): (\n  strings: Array<string>,\n  ...expressions: Array<string>\n) => SanitizedHTMLWrapper);\n\nconst flowDangerouslySetHTML = ((dangerouslySetHTML: any): (\n  html: string\n) => Object);\n\nconst flowConsumeSanitizedHTML = ((consumeSanitizedHTML: any): (\n  str: SanitizedHTMLWrapper\n) => string);\n\nconst flowEscape = ((escape: any): (str: string) => string);\n\nexport {\n  flowHtml as html,\n  flowDangerouslySetHTML as dangerouslySetHTML,\n  flowConsumeSanitizedHTML as consumeSanitizedHTML,\n  flowEscape as escape,\n  unescape,\n};\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport {createPlugin} from '../create-plugin';\nimport {escape, consumeSanitizedHTML} from '../sanitization';\nimport type {\n  Context,\n  SSRDecider as SSRDeciderService,\n  SSRBodyTemplate as SSRBodyTemplateService,\n} from '../types.js';\n\nconst botRegex = /(bot|crawler|spider)/i;\nconst SSRDecider = createPlugin<{}, SSRDeciderService>({\n  provides: () => {\n    return ctx => {\n      // If the request has one of these extensions, we assume it's not something that requires server-side rendering of virtual dom\n      // TODO(#46): this check should probably look at the asset manifest to ensure asset 404s are handled correctly\n      if (ctx.path.match(/\\.(js|gif|jpg|png|pdf|json)$/)) return false;\n\n      // Bots don't always include the accept header.\n      if (ctx.headers['user-agent']) {\n        const agent = ctx.headers['user-agent'];\n        if (botRegex.test(agent)) {\n          return true;\n        }\n      }\n\n      // The Accept header is a good proxy for whether SSR should happen\n      // Requesting an HTML page via the browser url bar generates a request with `text/html` in its Accept headers\n      // XHR/fetch requests do not have `text/html` in the Accept headers\n      if (!ctx.headers.accept) return false;\n      if (!ctx.headers.accept.includes('text/html')) return false;\n      return true;\n    };\n  },\n});\nexport {SSRDecider};\n\nexport default function createSSRPlugin({\n  element,\n  ssrDecider,\n  ssrBodyTemplate,\n}: {\n  element: any,\n  ssrDecider: SSRDeciderService,\n  ssrBodyTemplate?: SSRBodyTemplateService,\n}) {\n  return async function ssrPlugin(ctx: Context, next: () => Promise<void>) {\n    if (!ssrDecider(ctx)) return next();\n\n    const template = {\n      htmlAttrs: {},\n      bodyAttrs: {},\n      title: '',\n      head: [],\n      body: [],\n    };\n    ctx.element = element;\n    ctx.rendered = '';\n    ctx.template = template;\n    ctx.type = 'text/html';\n\n    await next();\n\n    // Allow someone to override the ssr by setting ctx.body\n    // This is especially useful for things like ctx.redirect\n    if (ctx.body && ctx.respond !== false) {\n      return;\n    }\n\n    if (ssrBodyTemplate) {\n      ctx.body = ssrBodyTemplate(ctx);\n    } else {\n      ctx.body = legacySSRBodyTemplate(ctx);\n    }\n  };\n}\n\nfunction legacySSRBodyTemplate(ctx) {\n  const {htmlAttrs, bodyAttrs, title, head, body} = ctx.template;\n  const safeAttrs = Object.keys(htmlAttrs)\n    .map(attrKey => {\n      return ` ${escape(attrKey)}=\"${escape(htmlAttrs[attrKey])}\"`;\n    })\n    .join('');\n\n  const safeBodyAttrs = Object.keys(bodyAttrs)\n    .map(attrKey => {\n      return ` ${escape(attrKey)}=\"${escape(bodyAttrs[attrKey])}\"`;\n    })\n    .join('');\n\n  const safeTitle = escape(title);\n  const safeHead = head.map(consumeSanitizedHTML).join('');\n  const safeBody = body.map(consumeSanitizedHTML).join('');\n\n  const preloadHintLinks = getPreloadHintLinks(ctx);\n  const coreGlobals = getCoreGlobals(ctx);\n  const chunkScripts = getChunkScripts(ctx);\n  const bundleSplittingBootstrap = [\n    preloadHintLinks,\n    coreGlobals,\n    chunkScripts,\n  ].join('');\n\n  return [\n    '<!doctype html>',\n    `<html${safeAttrs}>`,\n    `<head>`,\n    `<meta charset=\"utf-8\" />`,\n    `<title>${safeTitle}</title>`,\n    `${bundleSplittingBootstrap}${safeHead}`,\n    `</head>`,\n    `<body${safeBodyAttrs}>${ctx.rendered}${safeBody}</body>`,\n    '</html>',\n  ].join('');\n}\n\nfunction getCoreGlobals(ctx) {\n  const {webpackPublicPath, nonce} = ctx;\n\n  return [\n    `<script nonce=\"${nonce}\">`,\n    `window.performance && window.performance.mark && window.performance.mark('firstRenderStart');`,\n    `__ROUTE_PREFIX__ = ${JSON.stringify(ctx.prefix)};`, // consumed by ./client\n    `__WEBPACK_PUBLIC_PATH__ = ${JSON.stringify(webpackPublicPath)};`, // consumed by fusion-clientries/client-entry\n    `</script>`,\n  ].join('');\n}\n\nfunction getUrls({chunkUrlMap, webpackPublicPath}, chunks) {\n  // cross origin is needed to get meaningful errors in window.onerror\n  const isCrossOrigin = webpackPublicPath.startsWith('http');\n  const crossOriginAttribute = isCrossOrigin ? ' crossorigin=\"anonymous\"' : '';\n  return [...new Set(chunks)].map(id => {\n    let url = chunkUrlMap.get(id).get('es5');\n    if (webpackPublicPath.endsWith('/')) {\n      url = webpackPublicPath + url;\n    } else {\n      url = webpackPublicPath + '/' + url;\n    }\n    return {url, crossOriginAttribute};\n  });\n}\n\nfunction getChunkScripts(ctx) {\n  const sync = getUrls(ctx, ctx.syncChunks).map(\n    ({url, crossOriginAttribute}) => {\n      return `<script nonce=\"${\n        ctx.nonce\n      }\" defer${crossOriginAttribute} src=\"${url}\"></script>`;\n    }\n  );\n  const preloaded = getUrls(\n    ctx,\n    ctx.preloadChunks.filter(item => !ctx.syncChunks.includes(item))\n  ).map(({url, crossOriginAttribute}) => {\n    return `<script nonce=\"${\n      ctx.nonce\n    }\" defer${crossOriginAttribute} src=\"${url}\"></script>`;\n  });\n  return [...preloaded, ...sync].join('');\n}\n\nfunction getPreloadHintLinks(ctx) {\n  const chunks = [...ctx.preloadChunks, ...ctx.syncChunks];\n  const hints = getUrls(ctx, chunks).map(({url, crossOriginAttribute}) => {\n    return `<link rel=\"preload\"${crossOriginAttribute} href=\"${url}\" nonce=\"${\n      ctx.nonce\n    }\" as=\"script\" />`;\n  });\n  return hints.join('');\n}\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport {createPlugin} from './create-plugin';\nimport {createToken, TokenType, TokenImpl} from './create-token';\nimport {ElementToken, RenderToken, SSRDeciderToken} from './tokens';\nimport {SSRDecider} from './plugins/ssr';\n\nimport type {aliaser, cleanupFn, FusionPlugin, Token} from './types.js';\n\ninterface Register<T> {\n  (Token<T>, mixed): aliaser<Token<T>>;\n  (mixed): aliaser<Token<T>>;\n}\n\nclass FusionApp {\n  constructor(el: Element | string, render: any => any) {\n    this.registered = new Map(); // getTokenRef(token) -> {value, aliases, enhancers}\n    this.enhancerToToken = new Map(); // enhancer -> token\n    this._dependedOn = new Set();\n    this.plugins = []; // Token\n    this.cleanups = [];\n    el && this.register(ElementToken, el);\n    render && this.register(RenderToken, render);\n    this.register(SSRDeciderToken, SSRDecider);\n  }\n\n  // eslint-disable-next-line\n  registered: Map<\n    any,\n    {\n      aliases?: Map<any, any>,\n      enhancers?: Array<any>,\n      token: any,\n      value?: FusionPlugin<*, *>,\n    }\n  >;\n  enhancerToToken: Map<any, any>;\n  plugins: Array<any>;\n  cleanups: Array<cleanupFn>;\n  renderer: any;\n  _getService: any => any;\n  _dependedOn: Set<any>;\n\n  register: Register<*> = <T>(tokenOrValue, maybeValue) => {\n    const hasToken = tokenOrValue instanceof TokenImpl;\n    const token = hasToken\n      ? ((tokenOrValue: any): Token<T>)\n      : createToken('UnnamedPlugin');\n    const value: any = hasToken ? maybeValue : tokenOrValue;\n    if (!hasToken && (value == null || !value.__plugin__)) {\n      throw new Error(\n        __DEV__\n          ? `Cannot register ${String(\n              tokenOrValue\n            )} without a token. Did you accidentally register a ${\n              __NODE__ ? 'browser' : 'server'\n            } plugin on the ${__NODE__ ? 'server' : 'browser'}?`\n          : 'Invalid configuration registration'\n      );\n    }\n    // the renderer is a special case, since it needs to be always run last\n    if (token === RenderToken) {\n      this.renderer = value;\n      return {\n        alias: () => {\n          throw new Error('Aliasing for RenderToken not supported.');\n        },\n      };\n    }\n    token.stacks.push({type: 'register', stack: new Error().stack});\n    if (value && value.__plugin__) {\n      token.stacks.push({type: 'plugin', stack: value.stack});\n    }\n    return this._register(token, value);\n  };\n  _register<TResolved>(token: Token<TResolved>, value: *) {\n    this.plugins.push(token);\n    const {aliases, enhancers} = this.registered.get(getTokenRef(token)) || {\n      aliases: new Map(),\n      enhancers: [],\n    };\n    if (value && value.__plugin__) {\n      if (value.deps) {\n        Object.values(value.deps).forEach(token =>\n          this._dependedOn.add(getTokenRef(token))\n        );\n      }\n    }\n    this.registered.set(getTokenRef(token), {\n      value,\n      aliases,\n      enhancers,\n      token,\n    });\n    const alias = (sourceToken, destToken) => {\n      const stack = new Error().stack;\n      sourceToken.stacks.push({type: 'alias-from', stack});\n      destToken.stacks.push({type: 'alias-to', stack});\n      this._dependedOn.add(getTokenRef(destToken));\n      if (aliases) {\n        aliases.set(getTokenRef(sourceToken), destToken);\n      }\n      return {alias};\n    };\n    return {alias};\n  }\n  middleware(deps: *, middleware: *) {\n    if (middleware === undefined) {\n      middleware = () => deps;\n    }\n    this.register(createPlugin({deps, middleware}));\n  }\n  enhance<TResolved>(token: Token<TResolved>, enhancer: Function) {\n    token.stacks.push({type: 'enhance', stack: new Error().stack});\n    const {value, aliases, enhancers} = this.registered.get(\n      getTokenRef(token)\n    ) || {\n      aliases: new Map(),\n      enhancers: [],\n      value: undefined,\n    };\n    this.enhancerToToken.set(enhancer, token);\n\n    if (enhancers && Array.isArray(enhancers)) {\n      enhancers.push(enhancer);\n    }\n    this.registered.set(getTokenRef(token), {\n      value,\n      aliases,\n      enhancers,\n      token,\n    });\n  }\n  cleanup() {\n    return Promise.all(this.cleanups.map(fn => fn()));\n  }\n  resolve<TResolved>() {\n    if (!this.renderer) {\n      throw new Error('Missing registration for RenderToken');\n    }\n    this._register(RenderToken, this.renderer);\n    const resolved = new Map(); // Token.ref || Token => Service\n    const nonPluginTokens = new Set(); // Token\n    const resolving = new Set(); // Token.ref || Token\n    const registered = this.registered; // Token.ref || Token -> {value, aliases, enhancers}\n    const resolvedPlugins = []; // Plugins\n    const appliedEnhancers = [];\n    const resolveToken = (token: Token<TResolved>, tokenAliases) => {\n      // Base: if we have already resolved the type, return it\n      if (tokenAliases && tokenAliases.has(getTokenRef(token))) {\n        const newToken = tokenAliases.get(getTokenRef(token));\n        if (newToken) {\n          token = newToken;\n        }\n      }\n      if (resolved.has(getTokenRef(token))) {\n        return resolved.get(getTokenRef(token));\n      }\n\n      // Base: if currently resolving the same type, we have a circular dependency\n      if (resolving.has(getTokenRef(token))) {\n        throw new Error(`Cannot resolve circular dependency: ${token.name}`);\n      }\n\n      // Base: the type was never registered, throw error or provide undefined if optional\n      let {value, aliases, enhancers} =\n        registered.get(getTokenRef(token)) || {};\n      if (value === undefined) {\n        // Attempt to get default value, if optional\n        if (token instanceof TokenImpl && token.type === TokenType.Optional) {\n          this.register(token, undefined);\n        } else {\n          const dependents = Array.from(this.registered.entries());\n\n          /**\n           * Iterate over the entire list of dependencies and find all\n           * dependencies of a given token.\n           */\n          const findDependentTokens = () => {\n            return dependents\n              .filter(entry => {\n                if (!entry[1].value || !entry[1].value.deps) {\n                  return false;\n                }\n                return Object.values(entry[1].value.deps).includes(token);\n              })\n              .map(entry => entry[1].token.name);\n          };\n          const findDependentEnhancers = () => {\n            return appliedEnhancers\n              .filter(([, provides]) => {\n                if (!provides || !provides.deps) {\n                  return false;\n                }\n                return Object.values(provides.deps).includes(token);\n              })\n              .map(([enhancer]) => {\n                const enhancedToken = this.enhancerToToken.get(enhancer);\n                return `EnhancerOf<${\n                  enhancedToken ? enhancedToken.name : '(unknown)'\n                }>`;\n              });\n          };\n          const dependentTokens = [\n            ...findDependentTokens(),\n            ...findDependentEnhancers(),\n          ];\n\n          const base =\n            'A plugin depends on a token, but the token was not registered';\n          const downstreams =\n            'This token is required by plugins registered with tokens: ' +\n            dependentTokens.map(token => `\"${token}\"`).join(', ');\n          const stack = token.stacks.find(t => t.type === 'token');\n          const meta = `Required token: ${\n            token ? token.name : ''\n          }\\n${downstreams}\\n${stack ? stack.stack : ''}`;\n          const clue = 'Different tokens with the same name were detected:\\n\\n';\n          const suggestions = token\n            ? this.plugins\n                .filter(p => p.name === token.name)\n                .map(p => {\n                  const stack = p.stacks.find(t => t.type === 'token');\n                  return `${p.name}\\n${stack ? stack.stack : ''}\\n\\n`;\n                })\n                .join('\\n\\n')\n            : '';\n          const help =\n            'You may have multiple versions of the same plugin installed.\\n' +\n            'Ensure that `yarn list [the-plugin]` results in one version, ' +\n            'and use a yarn resolution or merge package version in your lock file to consolidate versions.\\n\\n';\n          throw new Error(\n            `${base}\\n\\n${meta}\\n\\n${suggestions && clue + suggestions + help}`\n          );\n        }\n      }\n\n      // Recursive: get the registered type and resolve it\n      resolving.add(getTokenRef(token));\n\n      function resolvePlugin(plugin) {\n        const registeredDeps = (plugin && plugin.deps) || {};\n        const resolvedDeps = {};\n        for (const key in registeredDeps) {\n          const registeredToken = registeredDeps[key];\n          resolvedDeps[key] = resolveToken(registeredToken, aliases);\n        }\n        // `provides` should be undefined if the plugin does not have a `provides` function\n        let provides =\n          plugin && plugin.provides ? plugin.provides(resolvedDeps) : undefined;\n        if (plugin && plugin.middleware) {\n          resolvedPlugins.push(plugin.middleware(resolvedDeps, provides));\n        }\n        return provides;\n      }\n\n      let provides = value;\n      if (value && value.__plugin__) {\n        provides = resolvePlugin(provides);\n        if (value.cleanup) {\n          this.cleanups.push(function() {\n            return typeof value.cleanup === 'function'\n              ? value.cleanup(provides)\n              : Promise.resolve();\n          });\n        }\n      } else {\n        nonPluginTokens.add(token);\n      }\n\n      if (enhancers && enhancers.length) {\n        enhancers.forEach(e => {\n          let nextProvides = e(provides);\n          appliedEnhancers.push([e, nextProvides]);\n          if (nextProvides && nextProvides.__plugin__) {\n            // if the token has a plugin enhancer, allow it to be registered with no dependents\n            nonPluginTokens.delete(token);\n            if (nextProvides.deps) {\n              Object.values(nextProvides.deps).forEach(token =>\n                this._dependedOn.add(getTokenRef(token))\n              );\n            }\n            nextProvides = resolvePlugin(nextProvides);\n          }\n          provides = nextProvides;\n        });\n      }\n      resolved.set(getTokenRef(token), provides);\n      resolving.delete(getTokenRef(token));\n      return provides;\n    };\n\n    for (let i = 0; i < this.plugins.length; i++) {\n      resolveToken(this.plugins[i]);\n    }\n    for (const token of nonPluginTokens) {\n      if (\n        token !== ElementToken &&\n        token !== RenderToken &&\n        !this._dependedOn.has(getTokenRef(token))\n      ) {\n        throw new Error(\n          `Registered token without depending on it: \"${token.name}\"`\n        );\n      }\n    }\n\n    this.plugins = resolvedPlugins;\n    this._getService = token => resolved.get(getTokenRef(token));\n  }\n  getService<TResolved>(token: Token<TResolved>): any {\n    if (!this._getService) {\n      throw new Error('Cannot get service from unresolved app');\n    }\n    return this._getService(token);\n  }\n}\n\n/* Helper functions */\nfunction getTokenRef(token) {\n  if (token instanceof TokenImpl) {\n    return token.ref;\n  }\n  return token;\n}\n\nexport default FusionApp;\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport type {Middleware} from './types.js';\n\n// inline version of koa-compose to get around Rollup/CUP commonjs-related issue\nexport function compose(middleware: Array<Middleware>): Middleware {\n  if (!Array.isArray(middleware)) {\n    throw new TypeError('Middleware stack must be an array!');\n  }\n  for (const fn of middleware) {\n    if (typeof fn !== 'function') {\n      throw new TypeError(\n        `Expected middleware function, received: ${typeof fn}`\n      );\n    }\n  }\n\n  return function(context, next) {\n    let index = -1;\n    return dispatch(0);\n    function dispatch(i) {\n      if (i <= index) {\n        return Promise.reject(new Error('next() called multiple times'));\n      }\n      index = i;\n      let fn = middleware[i];\n      if (i === middleware.length) fn = next;\n      if (!fn) return Promise.resolve();\n      try {\n        return fn(context, function next() {\n          return dispatch(i + 1);\n        });\n      } catch (err) {\n        return Promise.reject(err);\n      }\n    }\n  };\n}\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport type {Context} from './types.js';\n\ntype MemoizeFn<A> = (ctx: Context) => A;\n\nfunction Container() {}\n\nexport function memoize<A>(fn: MemoizeFn<A>): MemoizeFn<A> {\n  const memoizeKey = __NODE__ ? Symbol('memoize-key') : new Container();\n  return function memoized(ctx: Context) {\n    if (ctx.memoized.has(memoizeKey)) {\n      return ctx.memoized.get(memoizeKey);\n    }\n    const result = fn(ctx);\n    ctx.memoized.set(memoizeKey, result);\n    return result;\n  };\n}\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\nimport {createPlugin} from '../create-plugin';\nimport {memoize} from '../memoize';\nimport {createToken} from '../create-token';\nimport type {Token} from '../types.js';\n\ntype Deferred<T> = {\n  promise: Promise<T>,\n  resolve: (result: T) => void,\n  reject: (error: Error) => void,\n};\n\nclass Timing {\n  start: number;\n  render: Deferred<number>;\n  end: Deferred<number>;\n  downstream: Deferred<number>;\n  upstream: Deferred<number>;\n  upstreamStart: number;\n  constructor() {\n    this.start = now();\n    this.render = deferred();\n    this.end = deferred();\n    this.downstream = deferred();\n    this.upstream = deferred();\n    this.upstreamStart = -1;\n  }\n}\ntype TimingPlugin = {\n  from(ctx: Object): Timing,\n};\n\nconst timing: TimingPlugin = {\n  from: memoize(() => new Timing()),\n};\n\nexport const TimingToken: Token<TimingPlugin> = createToken('TimingToken');\n\nfunction middleware(ctx, next) {\n  ctx.memoized = new Map();\n  const {start, render, end, downstream, upstream} = timing.from(ctx);\n  ctx.timing = {\n    start,\n    render: render.promise,\n    end: end.promise,\n    downstream: downstream.promise,\n    upstream: upstream.promise,\n  };\n  return next()\n    .then(() => {\n      const upstreamTime = now() - timing.from(ctx).upstreamStart;\n      upstream.resolve(upstreamTime);\n      const endTime = now() - ctx.timing.start;\n      end.resolve(endTime);\n    })\n    .catch(e => {\n      // currently we only resolve upstream and downstream when the request does not error\n      // we should however always resolve the request end timing\n      if (e && e.status) {\n        // this ensures any logging / metrics based on ctx.status will recieve the correct status code\n        ctx.status = e.status;\n      }\n      const endTime = now() - ctx.timing.start;\n      end.resolve(endTime);\n      throw e;\n    });\n}\n\nexport default createPlugin<{}, typeof timing>({\n  provides: () => timing,\n  middleware: () => middleware,\n});\n\nexport function now(): number {\n  if (__NODE__) {\n    const [seconds, ns] = process.hrtime();\n    return Math.round(seconds * 1000 + ns / 1e6);\n  } else {\n    // eslint-disable-next-line cup/no-undef\n    if (window.performance && window.performance.now) {\n      // eslint-disable-next-line cup/no-undef\n      return Math.round(window.performance.now());\n    }\n    return Date.now();\n  }\n}\n\nfunction deferred<T>(): Deferred<T> {\n  let resolve = () => {};\n  let reject = () => {};\n  const promise = new Promise((res, rej) => {\n    resolve = res;\n    reject = rej;\n  });\n  return {\n    promise,\n    resolve,\n    reject,\n  };\n}\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport {now} from './timing';\n\nimport type {Context} from '../types.js';\n\nexport default function getRendererPlugin({\n  render,\n  timing,\n}: {\n  render: any,\n  timing: any,\n}) {\n  return async function renderer(ctx: Context, next: () => Promise<void>) {\n    const timer = timing.from(ctx);\n    timer.downstream.resolve(now() - timer.start);\n\n    let renderTime = null;\n    if (ctx.element && !ctx.body && ctx.respond !== false) {\n      const renderStart = now();\n      ctx.rendered = await render(ctx.element, ctx);\n      renderTime = now() - renderStart;\n    }\n\n    timer.upstreamStart = now();\n    await next();\n\n    if (ctx.element && typeof renderTime === 'number') {\n      timer.render.resolve(renderTime);\n    }\n  };\n}\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n/* eslint-env node */\nimport assert from 'assert';\n\nexport default (__BROWSER__ ? () => {} : loadEnv());\n\nfunction load(key, value) {\n  return process.env[key] || value;\n}\n\nexport function loadEnv() {\n  const rootDir = load('ROOT_DIR', '.');\n  const env = load('NODE_ENV', 'development');\n  if (!(env === 'development' || env === 'production' || env === 'test')) {\n    throw new Error(`Invalid NODE_ENV loaded: ${env}.`);\n  }\n  const prefix = load('ROUTE_PREFIX', '');\n  assert(!prefix.endsWith('/'), 'ROUTE_PREFIX must not end with /');\n  const baseAssetPath = load('FRAMEWORK_STATIC_ASSET_PATH', `/_static`);\n  assert(\n    !baseAssetPath.endsWith('/'),\n    'FRAMEWORK_STATIC_ASSET_PATH must not end with /'\n  );\n  const cdnUrl = load('CDN_URL', '');\n  assert(!cdnUrl.endsWith('/'), 'CDN_URL must not end with /');\n\n  const assetPath = `${prefix}${baseAssetPath}`;\n  return function loadEnv(): Env {\n    return {\n      rootDir,\n      env,\n      prefix,\n      assetPath,\n      baseAssetPath,\n      cdnUrl,\n      webpackPublicPath: cdnUrl || assetPath,\n    };\n  };\n}\n\n// Handle flow-types for export so browser export is ignored.\ntype Env = {\n  rootDir: string,\n  env: string,\n  prefix: string,\n  assetPath: string,\n  baseAssetPath: string,\n  cdnUrl: string,\n  webpackPublicPath: string,\n};\ndeclare export default () => Env;\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport uuidv4 from 'uuid/v4';\nimport UAParser from 'ua-parser-js';\nimport getEnv from '../get-env.js';\n\nimport type {Context} from '../types.js';\n\nconst envVars = getEnv();\n\nexport default function middleware(ctx: Context, next: () => Promise<void>) {\n  // env vars\n  ctx.rootDir = envVars.rootDir;\n  ctx.env = envVars.env;\n  ctx.prefix = envVars.prefix;\n  ctx.assetPath = envVars.assetPath;\n  ctx.cdnUrl = envVars.cdnUrl;\n\n  // webpack-related things\n  ctx.preloadChunks = [];\n  ctx.webpackPublicPath =\n    ctx.webpackPublicPath || envVars.cdnUrl || envVars.assetPath;\n\n  // these are set by fusion-cli, however since fusion-cli plugins are not added when\n  // running simulation tests, it is good to default them here\n  ctx.syncChunks = ctx.syncChunks || [];\n  ctx.chunkUrlMap = ctx.chunkUrlMap || new Map();\n\n  // fusion-specific things\n  ctx.nonce = uuidv4();\n  ctx.useragent = new UAParser(ctx.headers['user-agent']).getResult();\n  ctx.element = null;\n  ctx.rendered = null;\n\n  return next();\n}\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n/* eslint-env node */\nimport {compose} from './compose.js';\nimport Timing, {TimingToken} from './plugins/timing';\nimport BaseApp from './base-app';\nimport serverRenderer from './plugins/server-renderer';\nimport {\n  RenderToken,\n  ElementToken,\n  SSRDeciderToken,\n  SSRBodyTemplateToken,\n} from './tokens';\nimport ssrPlugin from './plugins/ssr';\nimport contextMiddleware from './plugins/server-context.js';\n\nexport default function(): typeof BaseApp {\n  const Koa = require('koa');\n\n  return class ServerApp extends BaseApp {\n    _app: Koa;\n    constructor(el, render) {\n      super(el, render);\n      this._app = new Koa();\n      this._app.proxy = true;\n      this.middleware(contextMiddleware);\n      this.register(TimingToken, Timing);\n      this.middleware(\n        {\n          element: ElementToken,\n          ssrDecider: SSRDeciderToken,\n          ssrBodyTemplate: SSRBodyTemplateToken.optional,\n        },\n        ssrPlugin\n      );\n    }\n    resolve() {\n      this.middleware(\n        {timing: TimingToken, render: RenderToken},\n        serverRenderer\n      );\n      return super.resolve();\n    }\n    callback() {\n      this.resolve();\n      this._app.use(compose(this.plugins));\n      return this._app.callback();\n    }\n  };\n}\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nexport function assetUrl(url: string): string {\n  /**\n   * PLEASE NOTE: a build step transforms\n   * the arguments provided to this function\n   */\n  return url;\n}\n\nexport function chunkId(filename: string): string {\n  /**\n   * PLEASE NOTE: a build step transforms\n   * the arguments provided to this function\n   */\n  return filename;\n}\n\nexport function syncChunkIds(argument: any): any {\n  /**\n   * PLEASE NOTE: a build step transforms\n   * the arguments provided to this function\n   */\n  return argument;\n}\n\nexport function syncChunkPaths(argument: any): any {\n  /**\n   * PLEASE NOTE: a build step transforms\n   * the arguments provided to this function\n   */\n  return argument;\n}\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\nimport type {\n  Context,\n  FusionPlugin,\n  Middleware,\n  Token,\n  SSRBodyTemplate,\n  RenderType as Render,\n} from './types.js';\n\nimport BaseApp from './base-app';\nimport serverApp from './server-app';\nimport clientApp from './client-app';\nimport getEnv from './get-env.js';\n\nexport default (__BROWSER__ ? clientApp() : serverApp());\n\nexport {compose} from './compose.js';\nexport {memoize} from './memoize';\n\n// sanitization API\nexport {\n  html,\n  dangerouslySetHTML,\n  consumeSanitizedHTML,\n  escape,\n  unescape,\n} from './sanitization';\n\n// Virtual modules\nexport {\n  assetUrl,\n  chunkId,\n  syncChunkIds,\n  syncChunkPaths,\n} from './virtual/index.js';\n\nexport {\n  RenderToken,\n  ElementToken,\n  SSRDeciderToken,\n  HttpServerToken,\n  SSRBodyTemplateToken,\n  RoutePrefixToken,\n  CriticalChunkIdsToken,\n} from './tokens';\nexport {createPlugin} from './create-plugin';\nexport {createToken} from './create-token';\nexport {getEnv};\n\ntype FusionApp = typeof BaseApp;\ndeclare export default typeof BaseApp;\nexport type {\n  Context,\n  FusionApp,\n  FusionPlugin,\n  Middleware,\n  Token,\n  SSRBodyTemplate,\n  Render,\n};\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport test from 'tape-cup';\nimport App from '../index';\n\ntest('interface', t => {\n  const element = () => 'hi';\n  const render = () => {};\n\n  const app = new App(element, render);\n  t.ok(app.plugins instanceof Array, 'sets plugins');\n  t.equal(typeof app.register, 'function', 'has a register function');\n  t.equal(typeof app.getService, 'function', 'has a getService function');\n  t.ok(typeof app.callback === 'function', 'callback is function');\n  t.ok(typeof app.callback() === 'function', 'callback returns server handler');\n  t.end();\n});\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport test from 'tape-cup';\nimport App from '../index';\nimport {compose} from '../compose.js';\n\nimport type {Context} from '../types.js';\n\ntest('context composition', async t => {\n  const element = 'hello';\n  const render = el => `<h1>${el}</h1>`;\n  const wrap = (ctx, next) => {\n    ctx.element = ctx.element.toUpperCase();\n    return next();\n  };\n  const chunkUrlMap = new Map();\n  const chunkIdZero = new Map();\n  chunkIdZero.set('es5', 'es5-file.js');\n  chunkUrlMap.set(0, chunkIdZero);\n  const context = {\n    headers: {accept: 'text/html'},\n    path: '/',\n    syncChunks: [0],\n    preloadChunks: [],\n    chunkUrlMap,\n    webpackPublicPath: '/',\n    element: null,\n    rendered: null,\n    render: null,\n    type: null,\n    body: null,\n  };\n\n  const app = new App(element, render);\n  app.middleware(wrap);\n  try {\n    app.resolve();\n    const middleware = compose(app.plugins);\n    // $FlowFixMe\n    await middleware(context, () => Promise.resolve());\n    // $FlowFixMe\n    t.equals(typeof context.rendered, 'string', 'renders');\n    // $FlowFixMe\n    t.ok(context.rendered.includes('<h1>HELLO</h1>'), 'has expected html');\n  } catch (e) {\n    t.ifError(e, 'something went wrong');\n  }\n  t.end();\n});\n\ntest('context composition with a cdn', async t => {\n  const element = 'hello';\n  const render = el => `<h1>${el}</h1>`;\n  const wrap = () => (ctx: Context, next: () => Promise<void>) => {\n    ctx.element = ctx.element.toUpperCase();\n    return next();\n  };\n  const chunkUrlMap = new Map();\n  const chunkIdZero = new Map();\n  chunkIdZero.set('es5', 'es5-file.js');\n  chunkUrlMap.set(0, chunkIdZero);\n  const context = {\n    headers: {accept: 'text/html'},\n    path: '/',\n    syncChunks: [0],\n    preloadChunks: [],\n    chunkUrlMap,\n    webpackPublicPath: 'https://something.com/lol',\n    element: null,\n    rendered: null,\n    render: null,\n    type: null,\n    body: null,\n  };\n\n  const app = new App(element, render);\n  app.middleware(wrap());\n  app.resolve();\n  const middleware = compose(app.plugins);\n  try {\n    await middleware(((context: any): Context), () => Promise.resolve());\n    // $FlowFixMe\n    t.ok(context.body.includes('https://something.com/lol/es5-file.js'));\n  } catch (e) {\n    t.ifError(e, 'something went wrong');\n  }\n  t.end();\n});\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport tape from 'tape-cup';\nimport type {tape$TestCb} from 'tape-cup';\nimport {compose} from '../compose';\n\nimport type {Context} from '../types.js';\n\nconst env = __BROWSER__ ? 'BROWSER' : 'NODE';\n\nfunction testHelper(tapeFn) {\n  return (name: string, testFn: tape$TestCb) => {\n    return tapeFn(`${env} - ${name}`, testFn);\n  };\n}\n\nconst test = testHelper(tape);\ntest.only = testHelper(tape.only.bind(tape));\ntest.skip = testHelper(tape.skip.bind(tape));\n\nexport default test;\n\nfunction getContext() {\n  return __BROWSER__\n    ? {}\n    : {\n        path: '/',\n        headers: {\n          accept: 'text/html',\n        },\n      };\n}\n\n// $FlowFixMe\nexport function run(app: any, ctx: Context = {}) {\n  // $FlowFixMe\n  ctx = Object.assign(getContext(), ctx);\n  app.resolve();\n  return compose(app.plugins)(ctx, () => Promise.resolve()).then(() => ctx);\n}\n","// @flow\nimport test from './test-helper';\nimport ClientAppFactory from '../client-app';\nimport ServerAppFactory from '../server-app';\nimport {createPlugin} from '../create-plugin';\n\nconst App = __BROWSER__ ? ClientAppFactory() : ServerAppFactory();\n\ntest('app.cleanup with no cleanup plugins', async t => {\n  const app = new App('el', el => el);\n  app.register(\n    createPlugin({\n      provides: () => 'hello world',\n      middleware: () => (ctx, next) => next(),\n    })\n  );\n  app.resolve();\n  await app.cleanup();\n  t.ok('cleans up ok');\n  t.end();\n});\n\ntest('app.cleanup with async cleanup plugins', async t => {\n  const app = new App('el', el => el);\n  let firstCleanupCalled = false;\n  let nextCleanupCalled = false;\n  app.register(\n    createPlugin({\n      provides: () => 'hello world',\n      cleanup: p => {\n        firstCleanupCalled = true;\n        t.equal(p, 'hello world', 'provides correct value to cleanup');\n        return Promise.resolve();\n      },\n      middleware: () => (ctx, next) => next(),\n    })\n  );\n  app.register(\n    createPlugin({\n      provides: () => 'another test',\n      cleanup: p => {\n        nextCleanupCalled = true;\n        t.equal(p, 'another test', 'provides correct value to cleanup');\n        return Promise.resolve();\n      },\n      middleware: () => (ctx, next) => next(),\n    })\n  );\n  app.resolve();\n  t.notOk(firstCleanupCalled, 'resolve() does not call cleanups');\n  t.notOk(nextCleanupCalled, 'resolve() does not call cleanups');\n  await app.cleanup();\n  t.ok(firstCleanupCalled, 'calls all cleanups');\n  t.ok(nextCleanupCalled, 'calls all cleanups');\n  t.end();\n});\n\ntest('app.cleanup does not cleanup if cleanup was not given a function', async t => {\n  const app = new App('el', el => el);\n  app.register(\n    createPlugin({\n      provides: () => 'hello world',\n      // $FlowFixMe - Ignore this to test branch\n      cleanup: 'notafunc',\n      middleware: () => (ctx, next) => next(),\n    })\n  );\n  app.resolve();\n  await app.cleanup();\n  t.end();\n});\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport test from './test-helper';\nimport {compose} from '../compose';\n\ntest('composed middleware are executed correctly', t => {\n  function A(ctx, next) {\n    return next();\n  }\n  const middleware = compose([A]);\n  const next = () => Promise.resolve();\n  // $FlowFixMe\n  t.doesNotThrow(() => middleware({}, next), 'works with valid args');\n  // $FlowFixMe\n  t.doesNotThrow(() => middleware(void 0, next), 'works with missing ctx');\n  // $FlowFixMe\n  t.doesNotThrow(() => middleware(), 'works with missing next');\n  t.end();\n});\n\ntest('downstream and upstream run in same order as koa', t => {\n  t.plan(6);\n  function a(ctx, next) {\n    t.equals(++ctx.number, 1, 'A downstream is called correctly');\n    return next().then(() => {\n      t.equals(++ctx.number, 6, 'A upstream is called correctly');\n    });\n  }\n  function b(ctx, next) {\n    t.equals(++ctx.number, 2, 'B downstream is called correctly');\n    return next().then(() => {\n      t.equals(++ctx.number, 5, 'B upstream is called correctly');\n    });\n  }\n  function c(ctx, next) {\n    t.equals(++ctx.number, 3, 'D downstream is called correctly');\n    return next().then(() => {\n      t.equals(++ctx.number, 4, 'D upstream is called correctly');\n    });\n  }\n  const middleware = compose([a, b, c]);\n  const ctx = {number: 0};\n  const next = () => Promise.resolve();\n  // $FlowFixMe\n  middleware(ctx, next).then(t.end);\n});\n","/* @flow */\nimport tape from 'tape-cup';\nimport ClientAppFactory from '../client-app';\nimport ServerAppFactory from '../server-app';\nimport {createPlugin} from '../create-plugin';\nimport {createToken} from '../create-token';\nimport type {FusionPlugin, Token} from '../types.js';\n\nconst App = __BROWSER__ ? ClientAppFactory() : ServerAppFactory();\ntype AType = {\n  a: string,\n};\ntype BType = {\n  b: string,\n};\ntype CType = {\n  c: string,\n};\ntype EType = {\n  e: string,\n};\nconst TokenA: Token<AType> = createToken('TokenA');\nconst TokenB: Token<BType> = createToken('TokenB');\nconst TokenC: Token<CType> = createToken('TokenC');\nconst TokenD: Token<BType> = createToken('TokenD');\nconst TokenEAsNullable: Token<?EType> = createToken('TokenEAsNullable');\nconst TokenString: Token<string> = createToken('TokenString');\nconst TokenNumber: Token<number> = createToken('TokenNumber');\n\ntape('dependency registration', t => {\n  const app = new App('el', el => el);\n  t.ok(app, 'creates an app');\n  const counters = {\n    a: 0,\n    b: 0,\n    c: 0,\n    d: 0,\n  };\n\n  const PluginA: FusionPlugin<void, AType> = createPlugin({\n    provides: () => {\n      counters.a++;\n      t.equal(counters.a, 1, 'only instantiates once');\n      return {\n        a: 'PluginA',\n      };\n    },\n  });\n  const PluginB: FusionPlugin<{a: Token<AType>}, BType> = createPlugin({\n    deps: {\n      a: TokenA,\n    },\n    provides: deps => {\n      counters.b++;\n      t.equal(deps.a.a, 'PluginA');\n      t.equal(counters.b, 1, 'only instantiates once');\n      return {\n        b: 'PluginB',\n      };\n    },\n  });\n\n  type PluginCType = FusionPlugin<{a: Token<AType>, b: Token<BType>}, CType>;\n  const PluginC: PluginCType = createPlugin({\n    deps: {\n      a: TokenA,\n      b: TokenB,\n    },\n    provides: deps => {\n      counters.c++;\n      t.equal(deps.a.a, 'PluginA');\n      t.equal(deps.b.b, 'PluginB');\n      t.equal(counters.c, 1, 'only instantiates once');\n      return {\n        c: 'PluginC',\n      };\n    },\n  });\n\n  app.register(TokenA, PluginA);\n  app.register(TokenB, PluginB);\n  app.register(TokenC, PluginC);\n  app.register(\n    createPlugin({\n      deps: {a: TokenA, b: TokenB, c: TokenC},\n      provides: deps => {\n        counters.d++;\n        t.equal(deps.a.a, 'PluginA');\n        t.equal(deps.b.b, 'PluginB');\n        t.equal(deps.c.c, 'PluginC');\n      },\n    })\n  );\n  t.equal(counters.a, 0, 'does not instantiate until resolve is called');\n  t.equal(counters.b, 0, 'does not instantiate until resolve is called');\n  t.equal(counters.c, 0, 'does not instantiate until resolve is called');\n  t.equal(counters.d, 0, 'does not instantiate until resolve is called');\n  app.resolve();\n  t.equal(counters.a, 1, 'only instantiates once');\n  t.equal(counters.b, 1, 'only instantiates once');\n  t.equal(counters.c, 1, 'only instantiates once');\n  t.equal(counters.d, 1, 'only instantiates once');\n  t.end();\n});\n\ntape('dependency registration with aliases', t => {\n  const app = new App('el', el => el);\n  t.ok(app, 'creates an app');\n  const counters = {\n    a: 0,\n    b: 0,\n    c: 0,\n    d: 0,\n  };\n\n  const PluginA: FusionPlugin<void, AType> = createPlugin({\n    provides: () => {\n      counters.a++;\n      t.equal(counters.a, 1, 'only instantiates once');\n      return {\n        a: 'PluginA',\n      };\n    },\n  });\n  const PluginB: FusionPlugin<{a: Token<AType>}, BType> = createPlugin({\n    deps: {\n      a: TokenA,\n    },\n    provides: deps => {\n      counters.b++;\n      t.equal(deps.a.a, 'PluginA');\n      t.equal(counters.b, 1, 'only instantiates once');\n      return {\n        b: 'PluginB',\n      };\n    },\n  });\n\n  type PluginCType = FusionPlugin<{a: Token<AType>, b: Token<BType>}, CType>;\n  const PluginC: PluginCType = createPlugin({\n    deps: {\n      a: TokenA,\n      b: TokenB,\n    },\n    provides: deps => {\n      counters.c++;\n      t.equal(deps.a.a, 'PluginA');\n      t.equal(deps.b.b, 'PluginD', 'uses correct alias');\n      t.equal(counters.c, 1, 'only instantiates once');\n      return {\n        c: 'PluginC',\n      };\n    },\n  });\n\n  const PluginD: FusionPlugin<{a: Token<AType>}, BType> = createPlugin({\n    deps: {\n      a: TokenA,\n    },\n    provides: deps => {\n      counters.d++;\n      t.equal(deps.a.a, 'PluginA');\n      t.equal(counters.d, 1, 'only instantiates once');\n      return {\n        b: 'PluginD',\n      };\n    },\n  });\n\n  app.register(TokenA, PluginA);\n  app.register(TokenB, PluginB);\n  app.register(TokenC, PluginC).alias(TokenB, TokenD);\n  app.register(TokenD, PluginD);\n  t.equal(counters.a, 0, 'does not instantiate until resolve is called');\n  t.equal(counters.b, 0, 'does not instantiate until resolve is called');\n  t.equal(counters.c, 0, 'does not instantiate until resolve is called');\n  t.equal(counters.d, 0, 'does not instantiate until resolve is called');\n  app.resolve();\n  t.equal(counters.a, 1, 'only instantiates once');\n  t.equal(counters.b, 1, 'only instantiates once');\n  t.equal(counters.c, 1, 'only instantiates once');\n  t.equal(counters.d, 1, 'only instantiates once');\n  t.end();\n});\n\ntape('optional dependency registration with aliases', t => {\n  const app = new App('el', el => el);\n  t.ok(app, 'creates an app');\n  const counters = {\n    a: 0,\n    b: 0,\n    c: 0,\n    d: 0,\n  };\n\n  const PluginA: FusionPlugin<void, AType> = createPlugin({\n    provides: () => {\n      counters.a++;\n      t.equal(counters.a, 1, 'only instantiates once');\n      return {\n        a: 'PluginA',\n      };\n    },\n  });\n  const PluginB: FusionPlugin<{a: Token<AType>}, BType> = createPlugin({\n    deps: {\n      a: TokenA,\n    },\n    provides: deps => {\n      counters.b++;\n      t.equal(deps.a.a, 'PluginA');\n      t.equal(counters.b, 1, 'only instantiates once');\n      return {\n        b: 'PluginB',\n      };\n    },\n  });\n\n  type PluginCType = FusionPlugin<\n    {a: typeof TokenA, b: typeof TokenB.optional},\n    CType\n  >;\n  const PluginC: PluginCType = createPlugin({\n    deps: {\n      a: TokenA,\n      b: TokenB.optional,\n    },\n    provides: deps => {\n      counters.c++;\n      t.equal(deps.a.a, 'PluginA');\n      t.equal(deps.b && deps.b.b, 'PluginD', 'uses correct alias');\n      t.equal(counters.c, 1, 'only instantiates once');\n      return {\n        c: 'PluginC',\n      };\n    },\n  });\n\n  const PluginD: FusionPlugin<{a: Token<AType>}, BType> = createPlugin({\n    deps: {\n      a: TokenA,\n    },\n    provides: deps => {\n      counters.d++;\n      t.equal(deps.a.a, 'PluginA');\n      t.equal(counters.d, 1, 'only instantiates once');\n      return {\n        b: 'PluginD',\n      };\n    },\n  });\n\n  app.register(TokenA, PluginA);\n  app.register(TokenB, PluginB);\n  app.register(TokenC, PluginC).alias(TokenB, TokenD);\n  app.register(TokenD, PluginD);\n  t.equal(counters.a, 0, 'does not instantiate until resolve is called');\n  t.equal(counters.b, 0, 'does not instantiate until resolve is called');\n  t.equal(counters.c, 0, 'does not instantiate until resolve is called');\n  t.equal(counters.d, 0, 'does not instantiate until resolve is called');\n  app.resolve();\n  t.equal(counters.a, 1, 'only instantiates once');\n  t.equal(counters.b, 1, 'only instantiates once');\n  t.equal(counters.c, 1, 'only instantiates once');\n  t.equal(counters.d, 1, 'only instantiates once');\n  t.end();\n});\n\ntape('dependency registration with aliasing non-plugins', t => {\n  const app = new App('el', el => el);\n  t.ok(app, 'creates an app');\n  const counters = {\n    a: 0,\n    b: 0,\n    c: 0,\n    d: 0,\n  };\n\n  const ValueA = 'some-value';\n  const AliasedValue = 'some-aliased-value';\n  const ValueTokenA: Token<string> = createToken('ValueA');\n  const AliasedTokenA: Token<string> = createToken('AliasedTokenA');\n  const PluginB: FusionPlugin<{a: Token<string>}, BType> = createPlugin({\n    deps: {\n      a: ValueTokenA,\n    },\n    provides: deps => {\n      counters.b++;\n      t.equal(deps.a, 'some-value');\n      t.equal(counters.b, 1, 'only instantiates once');\n      return {\n        b: 'PluginB',\n      };\n    },\n  });\n\n  type PluginCType = FusionPlugin<{a: Token<string>}, CType>;\n  const PluginC: PluginCType = createPlugin({\n    deps: {\n      a: ValueTokenA,\n    },\n    provides: deps => {\n      counters.c++;\n      t.equal(deps.a, 'some-aliased-value');\n      t.equal(counters.c, 1, 'only instantiates once');\n      return {\n        c: 'PluginC',\n      };\n    },\n  });\n\n  app.register(ValueTokenA, ValueA);\n  app.register(TokenB, PluginB);\n  app.register(TokenC, PluginC).alias(ValueTokenA, AliasedTokenA);\n  app.register(AliasedTokenA, AliasedValue);\n  t.equal(counters.b, 0, 'does not instantiate until resolve is called');\n  t.equal(counters.c, 0, 'does not instantiate until resolve is called');\n  app.resolve();\n  t.equal(counters.b, 1, 'only instantiates once');\n  t.equal(counters.c, 1, 'only instantiates once');\n  t.end();\n});\n\ntape('dependency registration with no token', t => {\n  const app = new App('el', el => el);\n  const PluginA: FusionPlugin<void, AType> = createPlugin({\n    provides: () => {\n      return {\n        a: 'PluginA',\n      };\n    },\n  });\n  const PluginB: FusionPlugin<{a: Token<AType>}, BType> = createPlugin({\n    deps: {\n      a: TokenA,\n    },\n    provides: deps => {\n      t.equal(deps.a.a, 'PluginA');\n      return {\n        b: 'PluginB',\n      };\n    },\n  });\n\n  app.register(TokenA, PluginA);\n  app.register(TokenB, PluginB);\n  app.register(\n    createPlugin({\n      deps: {a: TokenA, b: TokenB},\n      provides: deps => {\n        t.equal(deps.a.a, 'PluginA');\n        t.equal(deps.b.b, 'PluginB');\n      },\n    })\n  );\n  app.resolve();\n  t.end();\n});\n\ntape('dependency registration with middleware', t => {\n  const counters = {\n    a: 0,\n    b: 0,\n    c: 0,\n    d: 0,\n  };\n  const app = new App('el', el => el);\n  t.ok(app, 'creates an app');\n  const PluginA = createPlugin({\n    provides: () => {\n      counters.a++;\n      t.equal(counters.a, 1, 'only instantiates once');\n      return {\n        a: 'PluginA',\n      };\n    },\n  });\n  const PluginB = createPlugin({\n    deps: {a: TokenA},\n    provides: deps => {\n      counters.b++;\n      t.equal(deps.a.a, 'PluginA');\n      t.equal(counters.b, 1, 'only instantiates once');\n      return {\n        b: 'PluginB',\n      };\n    },\n  });\n  const PluginC = createPlugin({\n    deps: {a: TokenA, b: TokenB},\n    provides: deps => {\n      counters.c++;\n      t.equal(deps.a.a, 'PluginA');\n      t.equal(deps.b.b, 'PluginB');\n      t.equal(counters.c, 1, 'only instantiates once');\n      return {\n        c: 'PluginC',\n      };\n    },\n    middleware: () => (ctx, next) => next(),\n  });\n  app.register(TokenA, PluginA);\n  app.register(TokenB, PluginB);\n  app.register(TokenC, PluginC);\n  t.equal(counters.a, 0, 'does not instantiate until resolve is called');\n  t.equal(counters.b, 0, 'does not instantiate until resolve is called');\n  t.equal(counters.c, 0, 'does not instantiate until resolve is called');\n  app.resolve();\n  t.equal(counters.a, 1, 'only instantiates once');\n  t.equal(counters.b, 1, 'only instantiates once');\n  t.equal(counters.c, 1, 'only instantiates once');\n  t.end();\n});\n\ntape('dependency registration with missing dependency', t => {\n  const app = new App('el', el => el);\n  const PluginA = createPlugin({\n    provides: () => {\n      return {\n        a: 'PluginA',\n      };\n    },\n  });\n  const PluginC = createPlugin({\n    deps: {a: TokenA, b: TokenB},\n    provides: () => {\n      return {\n        c: 'PluginC',\n      };\n    },\n  });\n  app.register(TokenA, PluginA);\n  app.register(TokenC, PluginC);\n  t.throws(() => app.resolve(), 'Catches missing dependencies');\n  t.end();\n});\n\ntape('dependency registration with null value', t => {\n  const app = new App('el', el => el);\n\n  t.doesNotThrow(() => {\n    const PluginC = createPlugin({\n      deps: {optionalNull: TokenEAsNullable},\n      provides: deps => {\n        t.equal(deps.optionalNull, null, 'null provided as expected');\n      },\n    });\n    app.register(TokenEAsNullable, null);\n    app.register(PluginC);\n    app.resolve();\n  });\n\n  t.doesNotThrow(() => {\n    const app = new App('el', el => el);\n    // $FlowFixMe\n    app.register(TokenString, null);\n    app.middleware({something: TokenString}, ({something}) => {\n      t.equal(something, null, 'null provided as expected');\n      return (ctx, next) => next();\n    });\n    app.resolve();\n  });\n  t.end();\n});\n\ntape('dependency registration with optional deps', t => {\n  const app = new App('el', el => el);\n\n  const checkString = (s: string): void => {\n    t.equals(s, 'hello', 'correct string value is provided');\n  };\n  const checkNumUndefined = (n: void | number): void => {\n    t.equals(\n      n,\n      undefined,\n      'no number value is provided for unregistered optional token'\n    );\n  };\n\n  type Deps = {\n    str: string,\n    numOpt: void | number,\n  };\n  const PluginA = createPlugin({\n    deps: {\n      str: TokenString,\n      numOpt: TokenNumber.optional,\n    },\n    provides: ({str, numOpt}: Deps) => {\n      checkString(str);\n      checkNumUndefined(numOpt);\n\n      return {\n        a: 'Hello',\n      };\n    },\n  });\n  app.register(TokenString, 'hello');\n  app.register(PluginA);\n  app.resolve();\n  t.end();\n});\n\ntape('dependency registration with missing deep tree dependency', t => {\n  const app = new App('el', el => el);\n  const PluginA = createPlugin({\n    provides: () => {\n      return {\n        a: 'PluginA',\n      };\n    },\n  });\n  const PluginB = createPlugin({\n    deps: {a: TokenA, d: 'RANDOM-TOKEN'},\n    provides: () => {\n      return {\n        b: 'PluginB',\n      };\n    },\n  });\n  const PluginC = createPlugin({\n    deps: {a: TokenA, b: TokenB},\n    provides: () => {\n      return {\n        c: 'PluginC',\n      };\n    },\n  });\n  app.register(TokenC, PluginC);\n  app.register(TokenA, PluginA);\n  app.register(TokenB, PluginB);\n  t.throws(() => app.resolve(), 'Catches missing dependencies');\n  t.end();\n});\n\ntape('dependency registration with circular dependency', t => {\n  const app = new App('el', el => el);\n  const PluginB = createPlugin({\n    deps: {c: TokenC},\n    provides: () => {\n      return {\n        b: 'PluginB',\n      };\n    },\n  });\n  const PluginC = createPlugin({\n    deps: {b: TokenB},\n    provides: () => {\n      return {\n        c: 'PluginC',\n      };\n    },\n  });\n  app.register(TokenB, PluginB);\n  app.register(TokenC, PluginC);\n  t.throws(() => app.resolve(), 'Catches circular dependencies');\n  t.end();\n});\n\ntape('dependency configuration with missing deps', t => {\n  const ParentToken: Token<string> = createToken('parent-token');\n  const StringToken: Token<string> = createToken('string-token');\n  const OtherStringToken: Token<string> = createToken('other-string-token');\n\n  const app = new App('el', el => el);\n  app.register(\n    ParentToken,\n    createPlugin({\n      deps: {\n        a: StringToken,\n        b: OtherStringToken,\n      },\n      provides: () => {\n        t.fail('should not get here');\n        return 'service';\n      },\n    })\n  );\n  app.register(StringToken, 'string-a');\n  t.throws(() => app.resolve(), 'throws if dependencies are not configured');\n  t.throws(\n    () => app.resolve(),\n    /required by plugins registered with tokens: \"parent-token\"/\n  );\n  t.end();\n});\n\ntape('error message when dependent plugin does not have token', t => {\n  const StringToken: Token<string> = createToken('string-token');\n  const OtherStringToken: Token<string> = createToken('other-string-token');\n\n  const app = new App('el', el => el);\n  app.register(\n    createPlugin({\n      deps: {\n        a: StringToken,\n        b: OtherStringToken,\n      },\n      provides: () => {\n        t.fail('should not get here');\n        return {};\n      },\n    })\n  );\n  app.register(StringToken, 'string-a');\n  t.throws(\n    () => app.resolve(),\n    /required by plugins registered with tokens: \"UnnamedPlugin\"/\n  );\n  t.end();\n});\n\ntape('Extraneous dependencies', t => {\n  const app = new App('el', el => el);\n  const TestToken = createToken('test');\n  app.register(TestToken, 'some-value');\n  t.throws(() => app.resolve());\n  t.end();\n});\n\ntape('Extraneous dependencies after re-registering', t => {\n  const app = new App('el', el => el);\n  const TokenA = createToken('A');\n  const TokenB = createToken('B');\n  app.register(\n    TokenA,\n    createPlugin({\n      deps: {b: TokenB},\n    })\n  );\n  app.register(TokenB, 'test');\n  app.register(TokenA, createPlugin({}));\n  t.doesNotThrow(() => app.resolve());\n  t.end();\n});\n\ntape('Missing token errors reasonably', t => {\n  const app = new App('el', el => el);\n  // $FlowFixMe\n  t.throws(() => app.register('some-value'), /Cannot register some-value/);\n  const BrowserPlugin = null; // idiomatic browser plugin implementation for server-only plugin is `export default null`;\n  // $FlowFixMe\n  t.throws(() => app.register(BrowserPlugin), /Cannot register null/);\n  t.end();\n});\n\ntape('retrieve dependency', t => {\n  const app = new App('el', el => el);\n  const TokenA = createToken('a');\n  const PluginA = createPlugin({\n    provides: () => {\n      return {\n        a: 'Hello',\n      };\n    },\n  });\n\n  app.register(TokenA, PluginA);\n  app.resolve();\n  t.equal(app.getService(TokenA).a, 'Hello');\n  t.end();\n});\n\ntape('retrieve unresolved dependency', t => {\n  const app = new App('el', el => el);\n  const TokenA = createToken('a');\n  const PluginA = createPlugin({\n    provides: () => {\n      return {\n        a: 'Hello',\n      };\n    },\n  });\n\n  app.register(TokenA, PluginA);\n  t.throws(\n    () => app.getService(TokenA),\n    /Cannot get service from unresolved app/\n  );\n  t.end();\n});\n","/* @flow */\n\nimport tape from 'tape-cup';\nimport ClientAppFactory from '../client-app';\nimport ServerAppFactory from '../server-app';\nimport {createPlugin} from '../create-plugin';\nimport {createToken} from '../create-token';\nimport type {FusionPlugin, Token} from '../types.js';\n\nconst App = __BROWSER__ ? ClientAppFactory() : ServerAppFactory();\n\ntape('enhancement', t => {\n  const app = new App('el', el => el);\n\n  type FnType = string => string;\n  const FnToken: Token<FnType> = createToken('FnType');\n  const BaseFn: FusionPlugin<void, FnType> = createPlugin({\n    provides: () => {\n      return arg => arg;\n    },\n  });\n  const BaseFnEnhancer = (fn: FnType): FnType => {\n    return arg => {\n      return fn(arg) + ' enhanced';\n    };\n  };\n  app.register(FnToken, BaseFn);\n  app.enhance(FnToken, BaseFnEnhancer);\n  app.middleware({fn: FnToken}, ({fn}) => {\n    t.equal(fn('hello'), 'hello enhanced');\n    t.end();\n    return (ctx, next) => next();\n  });\n  app.resolve();\n});\n\ntape('enhancement with a plugin', t => {\n  const app = new App('el', el => el);\n\n  type FnType = string => string;\n  const FnToken: Token<FnType> = createToken('FnType');\n  const BaseFn: FusionPlugin<void, FnType> = createPlugin({\n    provides: () => {\n      return arg => arg;\n    },\n  });\n  const BaseFnEnhancer = (fn: FnType): FusionPlugin<void, FnType> => {\n    return createPlugin({\n      provides: () => {\n        return arg => {\n          return fn(arg) + ' enhanced';\n        };\n      },\n    });\n  };\n  app.register(FnToken, BaseFn);\n  app.enhance(FnToken, BaseFnEnhancer);\n  app.middleware({fn: FnToken}, ({fn}) => {\n    t.equal(fn('hello'), 'hello enhanced');\n    t.end();\n    return (ctx, next) => next();\n  });\n  app.resolve();\n});\n\ntape('enhancement with a plugin allows orphan plugins', t => {\n  const app = new App('el', el => el);\n\n  type FnType = string => string;\n  const FnToken: Token<FnType> = createToken('FnType');\n  const BaseFn: FnType = a => a;\n  const BaseFnEnhancer = (fn: FnType): FusionPlugin<void, FnType> => {\n    return createPlugin({\n      provides: () => {\n        return arg => {\n          return fn(arg) + ' enhanced';\n        };\n      },\n    });\n  };\n  app.register(FnToken, BaseFn);\n  app.enhance(FnToken, BaseFnEnhancer);\n  t.doesNotThrow(() => {\n    app.resolve();\n  });\n  t.end();\n});\n\ntape(\n  'enhancement with a non-plugin enhancer does not allow orphan plugins',\n  t => {\n    const app = new App('el', el => el);\n\n    type FnType = string => string;\n    const FnToken: Token<FnType> = createToken('FnType');\n    const BaseFn: FnType = a => a;\n    const BaseFnEnhancer = (fn: FnType): FnType => {\n      return fn;\n    };\n    app.register(FnToken, BaseFn);\n    app.enhance(FnToken, BaseFnEnhancer);\n    t.throws(() => {\n      app.resolve();\n    });\n    t.end();\n  }\n);\n\ntape('enhancement with a plugin with deps', t => {\n  const app = new App('el', el => el);\n\n  const DepAToken: Token<string> = createToken('DepA');\n  const DepBToken: Token<string> = createToken('DepB');\n  const DepCToken: Token<string> = createToken('DepC');\n\n  const DepA = 'test-dep-a';\n  const DepB: FusionPlugin<{a: Token<string>}, string> = createPlugin({\n    deps: {\n      a: DepAToken,\n    },\n    provides: ({a}) => {\n      t.equal(a, DepA);\n      return 'test-dep-b';\n    },\n  });\n\n  type FnType = string => string;\n  const FnToken: Token<FnType> = createToken('FnType');\n  const BaseFn: FusionPlugin<void, FnType> = createPlugin({\n    provides: () => {\n      return arg => arg;\n    },\n  });\n  const BaseFnEnhancer = (\n    fn: FnType\n  ): FusionPlugin<\n    {a: Token<string>, b: Token<string>, c: Token<string>},\n    FnType\n  > => {\n    return createPlugin({\n      deps: {\n        a: DepAToken,\n        b: DepBToken,\n        c: DepCToken,\n      },\n      provides: ({a, b, c}) => {\n        t.equal(a, 'test-dep-a');\n        t.equal(b, 'test-dep-b');\n        t.equal(c, 'test-dep-c');\n        return arg => {\n          return fn(arg) + ' enhanced';\n        };\n      },\n    });\n  };\n  app.register(DepAToken, DepA);\n  app.register(DepBToken, DepB);\n  app.register(DepCToken, 'test-dep-c');\n  app.register(FnToken, BaseFn);\n  app.enhance(FnToken, BaseFnEnhancer);\n  app.middleware({fn: FnToken}, ({fn}) => {\n    t.equal(fn('hello'), 'hello enhanced');\n    t.end();\n    return (ctx, next) => next();\n  });\n  app.resolve();\n});\n\ntape('enhancement with a plugin with missing deps', t => {\n  const app = new App('el', el => el);\n\n  const DepAToken: Token<string> = createToken('DepA');\n  const DepBToken: Token<string> = createToken('DepB');\n\n  const DepB = 'test-dep-b';\n\n  type FnType = string => string;\n  const FnToken: Token<FnType> = createToken('FnType');\n  const BaseFn: FusionPlugin<void, FnType> = createPlugin({\n    provides: () => {\n      return arg => arg;\n    },\n  });\n  const BaseFnEnhancer = (\n    fn: FnType\n  ): FusionPlugin<{a: Token<string>, b: Token<string>}, FnType> => {\n    return createPlugin({\n      deps: {\n        a: DepAToken,\n        b: DepBToken,\n      },\n      provides: () => {\n        t.fail('should not get here');\n        return arg => {\n          return fn(arg) + ' enhanced';\n        };\n      },\n    });\n  };\n  app.register(DepBToken, DepB);\n  app.register(FnToken, BaseFn);\n  app.enhance(FnToken, BaseFnEnhancer);\n  app.middleware({fn: FnToken}, ({fn}) => {\n    t.equal(fn('hello'), 'hello enhanced');\n    t.end();\n    return (ctx, next) => next();\n  });\n  t.throws(\n    () => app.resolve(),\n    /This token is required by plugins registered with tokens: \"EnhancerOf<FnType>\"/\n  );\n  t.end();\n});\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n/* eslint-env node */\nimport tape from 'tape-cup';\nimport {loadEnv} from '../get-env.js';\n\ntape('loadEnv defaults', t => {\n  const env = loadEnv()();\n  t.deepEqual(env, {\n    rootDir: '.',\n    env: 'development',\n    prefix: '',\n    assetPath: '/_static',\n    baseAssetPath: '/_static',\n    cdnUrl: '',\n    webpackPublicPath: '/_static',\n  });\n  t.end();\n});\n\ntape('loadEnv overrides', t => {\n  process.env.ROOT_DIR = 'test_root_dir';\n  process.env.NODE_ENV = 'production';\n  process.env.ROUTE_PREFIX = 'test_route_prefix';\n  process.env.FRAMEWORK_STATIC_ASSET_PATH = '/test_framework';\n  process.env.CDN_URL = 'test_cdn_url';\n\n  const env = loadEnv()();\n  t.deepEqual(env, {\n    rootDir: 'test_root_dir',\n    env: 'production',\n    prefix: 'test_route_prefix',\n    assetPath: 'test_route_prefix/test_framework',\n    baseAssetPath: '/test_framework',\n    cdnUrl: 'test_cdn_url',\n    webpackPublicPath: 'test_cdn_url',\n  });\n\n  process.env.ROOT_DIR = '';\n  process.env.NODE_ENV = '';\n  process.env.ROUTE_PREFIX = '';\n  process.env.FRAMEWORK_STATIC_ASSET_PATH = '';\n  process.env.CDN_URL = '';\n  t.end();\n});\n\ntape('loadEnv validation', t => {\n  process.env.NODE_ENV = 'LOL';\n  t.throws(loadEnv, /Invalid NODE_ENV loaded/);\n  process.env.NODE_ENV = '';\n\n  process.env.ROUTE_PREFIX = 'test/';\n  t.throws(loadEnv, /ROUTE_PREFIX must not end with /);\n  process.env.ROUTE_PREFIX = '';\n\n  process.env.FRAMEWORK_STATIC_ASSET_PATH = 'test/';\n  t.throws(loadEnv, /FRAMEWORK_STATIC_ASSET_PATH must not end with /);\n  process.env.FRAMEWORK_STATIC_ASSET_PATH = '';\n\n  process.env.CDN_URL = 'test/';\n  t.throws(loadEnv, /CDN_URL must not end with /);\n  process.env.CDN_URL = '';\n  t.end();\n});\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport test from 'tape-cup';\nimport App, {\n  html,\n  dangerouslySetHTML,\n  consumeSanitizedHTML,\n  escape,\n  unescape,\n  compose,\n  memoize,\n  assetUrl,\n  chunkId,\n  syncChunkIds,\n  syncChunkPaths,\n  RenderToken,\n  ElementToken,\n  SSRDeciderToken,\n  createPlugin,\n} from '../index.js';\n\ntest('fusion-core api', t => {\n  t.ok(App, 'exports App as default');\n  if (__NODE__) {\n    t.ok(html, 'exports html');\n    t.ok(dangerouslySetHTML, 'exports dangerouslySetHTML');\n    t.ok(consumeSanitizedHTML, 'exports consumeSanitizedHTML');\n    t.ok(escape, 'exports escape');\n  } else {\n    t.notok(html, 'does not export html in the browser');\n    t.notok(\n      dangerouslySetHTML,\n      'does not export dangerouslySetHTML in browser'\n    );\n    t.notok(\n      consumeSanitizedHTML,\n      'does not export consumeSanitizedHTML in browser'\n    );\n    t.notok(escape, 'does not export escape in browser');\n  }\n  t.ok(unescape, 'exports unescape');\n  t.ok(compose, 'exports compose');\n  t.ok(memoize, 'exports memoize');\n  t.ok(assetUrl, 'exports assetUrl');\n  t.ok(chunkId, 'exports chunkId');\n  t.ok(syncChunkIds, 'exports syncChunkIds');\n  t.ok(syncChunkPaths, 'exports syncChunkPaths');\n  t.ok(RenderToken, 'exports RenderToken');\n  t.ok(ElementToken, 'exports ElementToken');\n  t.ok(SSRDeciderToken, 'exports SSRDeciderToken');\n  t.ok(createPlugin, 'exports createPlugin');\n  t.end();\n});\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport test from 'tape-cup';\nimport App, {html} from '../index';\nimport {run} from './test-helper';\nimport {SSRDeciderToken} from '../tokens';\nimport {createPlugin} from '../create-plugin';\nimport BaseApp from '../base-app';\n\ntest('ssr with accept header', async t => {\n  const flags = {render: false};\n  const element = 'hi';\n  const render = () => {\n    flags.render = true;\n    return 'lol';\n  };\n  const app = new App(element, render);\n\n  app.middleware(async (ctx, next) => {\n    t.equals(ctx.element, element, 'sets ctx.element');\n    t.equals(ctx.type, 'text/html', 'sets ctx.type');\n    t.equals(typeof ctx.template, 'object', 'sets ctx.template');\n    t.equals(typeof ctx.template.title, 'string', 'sets ctx.template.title');\n    t.equals(typeof ctx.template.htmlAttrs, 'object', 'ctx.template.htmlAttrs');\n    // $FlowFixMe\n    t.equals(typeof ctx.template.bodyAttrs, 'object', 'ctx.template.bodyAttrs');\n    t.ok(ctx.template.head instanceof Array, 'ctx.template.head');\n    t.ok(ctx.template.body instanceof Array, 'ctx.template.body');\n    await next();\n    t.equals(\n      typeof ctx.template,\n      'object',\n      'ctx.template keeps structure on upstream'\n    );\n    t.equals(\n      typeof ctx.template.title,\n      'string',\n      'ctx.template.title keeps structure on upstream'\n    );\n    t.equals(\n      typeof ctx.template.htmlAttrs,\n      'object',\n      'ctx.template.htmlAttrs keeps structure on upstream'\n    );\n    t.equals(\n      // $FlowFixMe\n      typeof ctx.template.bodyAttrs,\n      'object',\n      'ctx.template.bodyAttrs keeps structure on upstream'\n    );\n    t.ok(\n      ctx.template.head instanceof Array,\n      'ctx.template.head keeps structure on upstream'\n    );\n    t.ok(\n      ctx.template.body instanceof Array,\n      'ctx.template.body keeps structure on upstream'\n    );\n  });\n  try {\n    // $FlowFixMe\n    const ctx = await run(app);\n    t.equals(typeof ctx.rendered, 'string', 'ctx.rendered');\n    t.equals(typeof ctx.body, 'string', 'renders ctx.body to string');\n    t.ok(!ctx.body.includes(element), 'does not renders element into ctx.body');\n    t.ok(flags.render, 'calls render');\n  } catch (e) {\n    t.ifError(e, 'should not error');\n  }\n  t.end();\n});\n\ntest('ssr with bot user agent', async t => {\n  const flags = {render: false};\n  const element = 'hi';\n  const render = () => {\n    flags.render = true;\n    return 'lol';\n  };\n  const app = new App(element, render);\n\n  app.middleware(async (ctx, next) => {\n    t.equals(ctx.element, element, 'sets ctx.element');\n    t.equals(ctx.type, 'text/html', 'sets ctx.type');\n    t.equals(typeof ctx.template, 'object', 'sets ctx.template');\n    t.equals(typeof ctx.template.title, 'string', 'sets ctx.template.title');\n    t.equals(typeof ctx.template.htmlAttrs, 'object', 'ctx.template.htmlAttrs');\n    // $FlowFixMe\n    t.equals(typeof ctx.template.bodyAttrs, 'object', 'ctx.template.bodyAttrs');\n    t.ok(ctx.template.head instanceof Array, 'ctx.template.head');\n    t.ok(ctx.template.body instanceof Array, 'ctx.template.body');\n    await next();\n    t.equals(\n      typeof ctx.template,\n      'object',\n      'ctx.template keeps structure on upstream'\n    );\n    t.equals(\n      typeof ctx.template.title,\n      'string',\n      'ctx.template.title keeps structure on upstream'\n    );\n    t.equals(\n      typeof ctx.template.htmlAttrs,\n      'object',\n      'ctx.template.htmlAttrs keeps structure on upstream'\n    );\n    t.equals(\n      // $FlowFixMe\n      typeof ctx.template.bodyAttrs,\n      'object',\n      'ctx.template.bodyAttrs keeps structure on upstream'\n    );\n    t.ok(\n      ctx.template.head instanceof Array,\n      'ctx.template.head keeps structure on upstream'\n    );\n    t.ok(\n      ctx.template.body instanceof Array,\n      'ctx.template.body keeps structure on upstream'\n    );\n  });\n  try {\n    // $FlowFixMe\n\n    let initialCtx = {\n      headers: {\n        accept: '*/*',\n        'user-agent': 'AdsBot-Google',\n      },\n    };\n    // $FlowFixMe\n    const ctx = await run(app, initialCtx);\n    t.equals(typeof ctx.rendered, 'string', 'ctx.rendered');\n    t.equals(typeof ctx.body, 'string', 'renders ctx.body to string');\n    t.ok(!ctx.body.includes(element), 'does not renders element into ctx.body');\n    t.ok(flags.render, 'calls render');\n  } catch (e) {\n    t.ifError(e, 'should not error');\n  }\n  t.end();\n});\n\ntest('ssr without valid accept header', async t => {\n  const flags = {render: false};\n  const element = 'hi';\n  const render = () => {\n    flags.render = true;\n  };\n  const app = new App(element, render);\n  let initialCtx = {\n    headers: {accept: '*/*'},\n  };\n  try {\n    // $FlowFixMe\n    const ctx = await run(app, initialCtx);\n    t.notok(ctx.element, 'does not set ctx.element');\n    t.notok(ctx.type, 'does not set ctx.type');\n    t.notok(ctx.body, 'does not set ctx.body');\n    t.ok(!flags.render, 'does not call render');\n    t.notok(ctx.body, 'does not render ctx.body to string');\n  } catch (e) {\n    t.ifError(e, 'does not error');\n  }\n  t.end();\n});\n\ntest('ssr without valid bot user agent', async t => {\n  const flags = {render: false};\n  const element = 'hi';\n  const render = () => {\n    flags.render = true;\n  };\n  const app = new App(element, render);\n  let initialCtx = {\n    headers: {\n      accept: '*/*',\n      'user-agent': 'test',\n    },\n  };\n  try {\n    // $FlowFixMe\n    const ctx = await run(app, initialCtx);\n    t.notok(ctx.element, 'does not set ctx.element');\n    t.notok(ctx.type, 'does not set ctx.type');\n    t.notok(ctx.body, 'does not set ctx.body');\n    t.ok(!flags.render, 'does not call render');\n    t.notok(ctx.body, 'does not render ctx.body to string');\n  } catch (e) {\n    t.ifError(e, 'does not error');\n  }\n  t.end();\n});\n\ntest('disable SSR by composing SSRDecider with a plugin', async t => {\n  const flags = {render: false};\n  const element = 'hi';\n  const render = () => {\n    flags.render = true;\n  };\n\n  function buildApp() {\n    const app = new App(element, render);\n\n    app.middleware((ctx, next) => {\n      ctx.body = '_NO_SSR_';\n      return next();\n    });\n\n    const SSRDeciderEnhancer = ssrDecider => {\n      return createPlugin({\n        provides: () => {\n          return ctx => {\n            return (\n              ssrDecider(ctx) &&\n              !ctx.path.startsWith('/foo') &&\n              !ctx.path.startsWith('/bar')\n            );\n          };\n        },\n      });\n    };\n    app.enhance(SSRDeciderToken, SSRDeciderEnhancer);\n    return app;\n  }\n\n  try {\n    let initialCtx = {\n      path: '/foo',\n    };\n    // $FlowFixMe\n    const ctx = await run(buildApp(), initialCtx);\n\n    t.notok(ctx.element, 'non-ssr route does not set ctx.element');\n    t.notok(ctx.type, 'non-ssr route does not set ctx.type');\n    t.ok(!flags.render, 'non-ssr route does not call render');\n    t.equals(ctx.body, '_NO_SSR_', 'can set body in plugin during non-ssr');\n\n    let validSSRPathCtx = {\n      path: '/some-path',\n    };\n    // $FlowFixMe\n    const renderCtx = await run(buildApp(), validSSRPathCtx);\n    t.equals(renderCtx.element, element, 'ssr route sets ctx.element');\n    t.equals(renderCtx.type, 'text/html', 'ssr route sets ctx.type');\n  } catch (e) {\n    t.ifError(e, 'does not error');\n  }\n  t.end();\n});\n\ntest('disable SSR by composing SSRDecider with a function', async t => {\n  const flags = {render: false};\n  const element = 'hi';\n  const render = () => {\n    flags.render = true;\n  };\n\n  function buildApp() {\n    const app = new App(element, render);\n\n    app.middleware((ctx, next) => {\n      ctx.body = '_NO_SSR_';\n      return next();\n    });\n\n    app.enhance(SSRDeciderToken, decide => ctx =>\n      decide(ctx) && !ctx.path.startsWith('/foo')\n    );\n    return app;\n  }\n\n  try {\n    let initialCtx = {\n      path: '/foo',\n    };\n    // $FlowFixMe\n    const ctx = await run(buildApp(), initialCtx);\n\n    t.notok(ctx.element, 'non-ssr route does not set ctx.element');\n    t.notok(ctx.type, 'non-ssr route does not set ctx.type');\n    t.ok(!flags.render, 'non-ssr route does not call render');\n    t.equals(ctx.body, '_NO_SSR_', 'can set body in plugin during non-ssr');\n\n    let validSSRPathCtx = {\n      path: '/some-path',\n    };\n    // $FlowFixMe\n    const renderCtx = await run(buildApp(), validSSRPathCtx);\n    t.equals(renderCtx.element, element, 'ssr route sets ctx.element');\n    t.equals(renderCtx.type, 'text/html', 'ssr route sets ctx.type');\n  } catch (e) {\n    t.ifError(e, 'does not error');\n  }\n  t.end();\n});\n\ntest('SSR extension handling', async t => {\n  const extensionToSSRSupported = {\n    js: false,\n    gif: false,\n    jpg: false,\n    png: false,\n    pdf: false,\n    json: false,\n    html: true,\n  };\n\n  const flags = {render: false};\n  const element = 'hi';\n  const render = () => {\n    flags.render = true;\n  };\n\n  function buildApp() {\n    const app = new App(element, render);\n    return app;\n  }\n\n  try {\n    for (let i in extensionToSSRSupported) {\n      flags.render = false;\n      let initialCtx = {\n        path: `/some-path.${i}`,\n      };\n      // $FlowFixMe\n      await run(buildApp(), initialCtx);\n      const shouldSSR = extensionToSSRSupported[i];\n      t.equals(\n        flags.render,\n        shouldSSR,\n        `extension of ${i} should ${shouldSSR ? '' : 'not'} have ssr`\n      );\n    }\n  } catch (e) {\n    t.ifError(e, 'does not error');\n  }\n  t.end();\n});\n\ntest('SSR with redirects downstream', async t => {\n  const flags = {render: false};\n  const element = 'hi';\n  const render = () => {\n    flags.render = true;\n    return 'lol';\n  };\n  const app = new App(element, render);\n\n  app.middleware(async (ctx, next) => {\n    t.equals(ctx.element, element, 'sets ctx.element');\n    t.equals(ctx.type, 'text/html', 'sets ctx.type');\n    t.equals(typeof ctx.template, 'object', 'sets ctx.template');\n    t.equals(typeof ctx.template.title, 'string', 'sets ctx.template.title');\n    t.equals(typeof ctx.template.htmlAttrs, 'object', 'ctx.template.htmlAttrs');\n    // $FlowFixMe\n    t.equals(typeof ctx.template.bodyAttrs, 'object', 'ctx.template.bodyAttrs');\n    t.ok(ctx.template.head instanceof Array, 'ctx.template.head');\n    t.ok(ctx.template.body instanceof Array, 'ctx.template.body');\n    ctx.status = 302;\n    ctx.body = 'redirect';\n    await next();\n    t.equals(\n      typeof ctx.template,\n      'object',\n      'ctx.template keeps structure on upstream'\n    );\n    t.equals(\n      typeof ctx.template.title,\n      'string',\n      'ctx.template.title keeps structure on upstream'\n    );\n    t.equals(\n      typeof ctx.template.htmlAttrs,\n      'object',\n      'ctx.template.htmlAttrs keeps structure on upstream'\n    );\n    t.equals(\n      // $FlowFixMe\n      typeof ctx.template.bodyAttrs,\n      'object',\n      'ctx.template.bodyAttrs keeps structure on upstream'\n    );\n    t.ok(\n      ctx.template.head instanceof Array,\n      'ctx.template.head keeps structure on upstream'\n    );\n    t.ok(\n      ctx.template.body instanceof Array,\n      'ctx.template.body keeps structure on upstream'\n    );\n  });\n  try {\n    const ctx = await run(app);\n    t.equal(ctx.status, 302, 'sends 302 status code');\n    t.notok(ctx.rendered, 'does not render');\n    t.equal(typeof ctx.body, 'string');\n    t.notok(flags.render, 'does not call render');\n  } catch (e) {\n    t.ifError(e, 'should not error');\n  }\n  t.end();\n});\n\ntest('SSR with redirects upstream', async t => {\n  const flags = {render: false};\n  const element = 'hi';\n  const render = () => {\n    flags.render = true;\n    return 'lol';\n  };\n  const app = new App(element, render);\n\n  app.middleware(async (ctx, next) => {\n    t.equals(ctx.element, element, 'sets ctx.element');\n    t.equals(ctx.type, 'text/html', 'sets ctx.type');\n    t.equals(typeof ctx.template, 'object', 'sets ctx.template');\n    t.equals(typeof ctx.template.title, 'string', 'sets ctx.template.title');\n    t.equals(typeof ctx.template.htmlAttrs, 'object', 'ctx.template.htmlAttrs');\n    // $FlowFixMe\n    t.equals(typeof ctx.template.bodyAttrs, 'object', 'ctx.template.bodyAttrs');\n    t.ok(ctx.template.head instanceof Array, 'ctx.template.head');\n    t.ok(ctx.template.body instanceof Array, 'ctx.template.body');\n    await next();\n    ctx.status = 302;\n    ctx.body = 'redirect';\n    t.equals(\n      typeof ctx.template,\n      'object',\n      'ctx.template keeps structure on upstream'\n    );\n    t.equals(\n      typeof ctx.template.title,\n      'string',\n      'ctx.template.title keeps structure on upstream'\n    );\n    t.equals(\n      typeof ctx.template.htmlAttrs,\n      'object',\n      'ctx.template.htmlAttrs keeps structure on upstream'\n    );\n    t.equals(\n      // $FlowFixMe\n      typeof ctx.template.bodyAttrs,\n      'object',\n      'ctx.template.bodyAttrs keeps structure on upstream'\n    );\n    t.ok(\n      ctx.template.head instanceof Array,\n      'ctx.template.head keeps structure on upstream'\n    );\n    t.ok(\n      ctx.template.body instanceof Array,\n      'ctx.template.body keeps structure on upstream'\n    );\n  });\n  try {\n    const ctx = await run(app);\n    t.equal(ctx.status, 302, 'sends 302 status code');\n    t.equal(ctx.rendered, 'lol', 'renders');\n    t.equal(typeof ctx.body, 'string');\n    t.ok(flags.render, 'calls render');\n  } catch (e) {\n    t.ifError(e, 'should not error');\n  }\n  t.end();\n});\n\ntest('HTML escaping works', async t => {\n  const element = 'hi';\n  const render = el => el;\n  const template = (ctx, next) => {\n    ctx.template.htmlAttrs = {lang: '\">'};\n    // $FlowFixMe\n    ctx.template.bodyAttrs = {test: '\">'};\n    ctx.template.title = '</title>';\n    return next();\n  };\n  const app = new App(element, render);\n  app.middleware(template);\n\n  try {\n    // $FlowFixMe\n    const ctx = await run(app);\n    t.ok(ctx.body.includes('<html lang=\"\\\\u0022\\\\u003E\">'), 'lang works');\n    t.ok(ctx.body.includes('<body test=\"\\\\u0022\\\\u003E\">'), 'bodyAttrs work');\n    t.ok(\n      ctx.body.includes('<title>\\\\u003C\\\\u002Ftitle\\\\u003E</title>'),\n      'title works'\n    );\n  } catch (e) {\n    t.ifError(e, 'does not error');\n  }\n  t.end();\n});\n\ntest('head and body must be sanitized', async t => {\n  const element = 'hi';\n  const render = el => el;\n  const template = (ctx, next) => {\n    ctx.template.head.push(\n      html`\n        <meta charset=\"${'\">'}\" />\n      `\n    );\n    ctx.template.body.push(\n      html`\n        <div>${'\">'}</div>\n      `\n    );\n    return next();\n  };\n  const app = new App(element, render);\n  app.middleware(template);\n  try {\n    // $FlowFixMe\n    const ctx = await run(app);\n    t.ok(ctx.body.includes('<meta charset=\"\\\\u0022\\\\u003E\" />'), 'head works');\n    t.ok(ctx.body.includes('<div>\\\\u0022\\\\u003E</div>'), 'body works');\n  } catch (e) {\n    t.ifError(e, 'does not error');\n  }\n  t.end();\n});\n\ntest('throws if head is not sanitized', async t => {\n  const element = 'hi';\n  const render = el => el;\n  const template = (ctx, next) => {\n    // $FlowFixMe\n    ctx.template.head.push(`<meta charset=\"${'\">'}\" />`);\n    return next();\n  };\n  const app = new App(element, render);\n  app.middleware(template);\n  try {\n    await run(app);\n    t.fail('should throw');\n  } catch (e) {\n    t.ok(e, 'throws if head is not sanitized');\n  }\n  t.end();\n});\n\ntest('throws if body is not sanitized', async t => {\n  const element = 'hi';\n  const render = el => el;\n  const template = (ctx, next) => {\n    // $FlowFixMe\n    ctx.template.body.push(`<meta charset=\"${'\">'}\" />`);\n    return next();\n  };\n  const app = new App(element, render);\n  app.middleware(template);\n\n  try {\n    await run(app);\n    t.fail('should throw');\n  } catch (e) {\n    t.ok(e, 'throws if body is not sanitized');\n  }\n  t.end();\n});\n\ntest('rendering error handling', async t => {\n  const element = 'hi';\n  const render = () => {\n    return new Promise(() => {\n      throw new Error('Test error');\n    });\n  };\n  const app = new App(element, render);\n  try {\n    await run(app);\n  } catch (e) {\n    t.equal(e.message, 'Test error');\n    t.end();\n  }\n});\n\ntest('app handles no render token', async t => {\n  const app = new BaseApp('el', el => el);\n  app.renderer = null;\n  try {\n    await app.resolve();\n    t.end();\n  } catch (e) {\n    t.equal(e.message, 'Missing registration for RenderToken');\n    t.end();\n  }\n});\n\ntest('enable proxy flag', async t => {\n  const flags = {render: false};\n  const element = 'hi';\n  const render = () => {\n    flags.render = true;\n    return 'lol';\n  };\n  const app = new App(element, render);\n  // $FlowFixMe\n  t.equal(app._app.proxy, true, 'fusion proxy should be true by default');\n  t.end();\n});\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport test from './test-helper';\nimport {memoize} from '../memoize';\n\nimport type {Context} from '../types.js';\n\ntest('memoize', t => {\n  // $FlowFixMe\n  const mockCtx: Context = {\n    memoized: new Map(),\n  };\n\n  let counter = 0;\n  const memoized = memoize(() => {\n    return ++counter;\n  });\n\n  let counterB = 0;\n  const memoizedB = memoize(() => {\n    return ++counterB;\n  });\n\n  t.equal(memoized(mockCtx), 1, 'calls function when it has no value');\n  t.equal(memoized(mockCtx), 1, 'memoizes correctly');\n  t.equal(memoizedB(mockCtx), 1, 'calls function when it has no value');\n  t.equal(memoizedB(mockCtx), 1, 'memoizes correctly');\n  t.equal(memoized(mockCtx), 1, 'calls function when it has no value');\n  t.equal(memoized(mockCtx), 1, 'memoizes correctly');\n  t.end();\n});\n","/* @flow */\n\nimport test, {run} from './test-helper';\nimport ClientAppFactory from '../client-app';\nimport ServerAppFactory from '../server-app';\nimport {createPlugin} from '../create-plugin';\nimport {createToken} from '../create-token';\nimport type {Token} from '../types.js';\n\nconst App = __BROWSER__ ? ClientAppFactory() : ServerAppFactory();\ntype AType = {\n  a: string,\n};\ntype BType = () => {\n  b: string,\n};\nconst TokenA: Token<AType> = createToken('TokenA');\nconst TokenB: Token<BType> = createToken('TokenB');\nconst TokenString: Token<string> = createToken('TokenString');\n\nfunction delay() {\n  return new Promise(resolve => {\n    setTimeout(resolve, 1);\n  });\n}\n\ntest('async render', async t => {\n  let numRenders = 0;\n  const element = 'hi';\n  const renderFn = el => {\n    t.equals(el, element, 'render receives correct args');\n    return delay().then(() => {\n      numRenders++;\n      return el;\n    });\n  };\n  const app = new App(element, renderFn);\n  const ctx = await run(app);\n  t.ok(ctx.element, 'sets ctx.element');\n  t.equal(ctx.rendered, element);\n  t.equal(numRenders, 1, 'calls render once');\n  t.equal(ctx.element, element, 'sets ctx.element');\n  t.end();\n});\n\ntest('sync render', async t => {\n  let numRenders = 0;\n  const element = 'hi';\n  const renderFn = el => {\n    numRenders++;\n    t.equals(el, element, 'render receives correct args');\n    return el;\n  };\n  const app = new App(element, renderFn);\n  const ctx = await run(app);\n  t.equal(ctx.rendered, element);\n  t.equal(numRenders, 1, 'calls render once');\n  t.equal(ctx.element, element, 'sets ctx.element');\n  t.end();\n});\n\ntest('render plugin order', async t => {\n  let numRenders = 0;\n  const element = 'hi';\n  let order = 0;\n  const renderFn = el => {\n    order++;\n    t.equals(el, element, 'render receives correct args');\n    t.equal(order, 3, 'runs render function last');\n    return delay().then(() => {\n      numRenders++;\n      return el;\n    });\n  };\n  const renderPlugin = createPlugin({\n    provides: () => renderFn,\n    middleware: () => (ctx, next) => {\n      order++;\n      t.equal(\n        ctx.element,\n        element,\n        'sets ctx.element before running render middleware'\n      );\n      t.equal(order, 2, 'runs render middleware before render');\n      return next();\n    },\n  });\n  // TODO(#137): fix flow types for renderPlugin\n  // $FlowFixMe\n  const app = new App(element, renderPlugin);\n  app.middleware((ctx, next) => {\n    order++;\n    t.equal(order, 1, 'runs middleware before renderer');\n    return next();\n  });\n  const ctx = await run(app);\n  t.ok(ctx.element, 'sets ctx.element');\n  t.equal(ctx.rendered, element);\n  t.equal(numRenders, 1, 'calls render once');\n  t.equal(ctx.element, element, 'sets ctx.element');\n  t.end();\n});\n\ntest('app.register - async render with async middleware', async t => {\n  let numRenders = 0;\n  const element = 'hi';\n  const renderFn = el => {\n    t.equals(el, element, 'render receives correct args');\n    return delay().then(() => {\n      numRenders++;\n      return el;\n    });\n  };\n  const app = new App(element, renderFn);\n  app.middleware(async (ctx, next) => {\n    t.equal(ctx.element, element);\n    t.equal(numRenders, 0);\n    t.notok(ctx.rendered);\n    await next();\n    t.equal(numRenders, 1);\n    t.equal(ctx.rendered, element);\n  });\n  const ctx = await run(app);\n  t.equal(ctx.rendered, element);\n  t.equal(numRenders, 1, 'calls render');\n  t.equal(ctx.element, element, 'sets ctx.element');\n  t.end();\n});\n\ntest('app.register - middleware execution respects registration order', async t => {\n  let numRenders = 0;\n  const element = 'hi';\n  const renderFn = el => {\n    t.equals(el, element, 'render receives correct args');\n    return delay().then(() => {\n      numRenders++;\n      return el;\n    });\n  };\n  const app = new App(element, renderFn);\n  let order = 0;\n  app.middleware(async (ctx, next) => {\n    t.equal(order, 0, 'calls downstream in correct order');\n    order++;\n    t.equal(ctx.element, element);\n    t.equal(numRenders, 0);\n    t.notok(ctx.rendered);\n    await next();\n    t.equal(order, 3, 'calls upstream in correct order');\n    t.equal(numRenders, 1);\n    t.equal(ctx.rendered, element);\n    order++;\n  });\n  app.middleware(async (ctx, next) => {\n    t.equal(order, 1, 'calls downstream in correct order');\n    order++;\n    t.equal(ctx.element, element);\n    t.equal(numRenders, 0);\n    t.notok(ctx.rendered);\n    await next();\n    t.equal(order, 2, 'calls upstream in correct order');\n    order++;\n    t.equal(numRenders, 1);\n    t.equal(ctx.rendered, element);\n  });\n  const ctx = await run(app);\n  t.equal(ctx.rendered, element);\n  t.equal(numRenders, 1, 'calls render');\n  t.equal(order, 4, 'calls middleware in correct order');\n  t.end();\n});\n\ntest('app.register - middleware execution respects dependency order', async t => {\n  let numRenders = 0;\n  const element = 'hi';\n  const renderFn = el => {\n    t.equals(el, element, 'render receives correct args');\n    return delay().then(() => {\n      numRenders++;\n      return el;\n    });\n  };\n  const app = new App(element, renderFn);\n  let order = 0;\n  app.middleware(async function first(ctx, next) {\n    t.equal(order, 0, 'calls downstream in correct order');\n    t.equal(numRenders, 0);\n    order++;\n    await next();\n    t.equal(order, 7, 'calls upstream in correct order');\n    t.equal(numRenders, 1);\n    order++;\n  });\n  app.register(\n    TokenA,\n    createPlugin({\n      deps: {TokenB},\n      provides: deps => {\n        t.equal(deps.TokenB().b, 'something-b');\n        return {a: 'something'};\n      },\n      middleware: deps => {\n        t.equal(deps.TokenB().b, 'something-b');\n        return async function second(ctx, next) {\n          t.equal(order, 2, 'calls downstream in correct order');\n          t.equal(numRenders, 0);\n          order++;\n          await next();\n          t.equal(order, 5, 'calls upstream in correct order');\n          t.equal(numRenders, 1);\n          order++;\n        };\n      },\n    })\n  );\n  app.middleware(async function third(ctx, next) {\n    t.equal(order, 3, 'calls downstream in correct order');\n    t.equal(numRenders, 0);\n    order++;\n    await next();\n    t.equal(order, 4, 'calls upstream in correct order');\n    t.equal(numRenders, 1);\n    order++;\n  });\n  app.register(\n    TokenB,\n    createPlugin({\n      provides: () => () => ({b: 'something-b'}),\n      middleware: () => {\n        return async function fourth(ctx, next) {\n          t.equal(order, 1, 'calls downstream in correct order');\n          t.equal(numRenders, 0);\n          order++;\n          await next();\n          t.equal(order, 6, 'calls upstream in correct order');\n          t.equal(numRenders, 1);\n          order++;\n        };\n      },\n    })\n  );\n  const ctx = await run(app);\n  t.equal(ctx.rendered, element);\n  t.equal(numRenders, 1, 'calls render');\n  t.equal(order, 8, 'calls middleware in correct order');\n  t.end();\n});\n\ntest('app.middleware with dependencies', async t => {\n  const element = 'hi';\n  const renderFn = el => {\n    return el;\n  };\n  const app = new App(element, renderFn);\n  let called = false;\n  app.register(TokenString, 'Something');\n  app.middleware({TokenString}, deps => {\n    t.equal(deps.TokenString, 'Something');\n    return (ctx, next) => {\n      called = true;\n      return next();\n    };\n  });\n  await run(app);\n  t.ok(called, 'calls middleware');\n  t.end();\n});\n\ntest('app.middleware with no dependencies', async t => {\n  const element = 'hi';\n  const renderFn = el => {\n    return el;\n  };\n  const app = new App(element, renderFn);\n  let called = false;\n  app.middleware((ctx, next) => {\n    called = true;\n    return next();\n  });\n  await run(app);\n  t.ok(called, 'calls middleware');\n  t.end();\n});\n\n__NODE__ &&\n  test('ctx.respond as false', async t => {\n    const element = 'hi';\n    const renderFn = el => {\n      t.fail('should not render if ctx.respond is false');\n      return el;\n    };\n    const app = new App(element, renderFn);\n    app.middleware((ctx, next) => {\n      ctx.respond = false;\n      return next();\n    });\n    const ctx = await run(app);\n    t.notOk(ctx.rendered, 'should not render');\n    t.end();\n  });\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport test from 'tape-cup';\nimport {\n  html,\n  consumeSanitizedHTML,\n  dangerouslySetHTML,\n  escape,\n  unescape,\n} from '../sanitization';\n\ntest('escaping works', async t => {\n  t.equals(\n    escape('<meta name=\"\" />'),\n    '\\\\u003Cmeta name=\\\\u0022\\\\u0022 \\\\u002F\\\\u003E'\n  );\n  t.end();\n});\ntest('unescaping works', async t => {\n  t.equals(\n    unescape('\\\\u003Cmeta name=\\\\u0022\\\\u0022 \\\\u002F\\\\u003E'),\n    '<meta name=\"\" />'\n  );\n  t.end();\n});\ntest('html sanitization works', async t => {\n  const userData = '<malicious data=\"\" />';\n  const value = html`\n    <div>${userData}</div>\n    ${null}\n  `;\n  t.equals(typeof value, 'object');\n  t.equals(\n    // $FlowFixMe\n    consumeSanitizedHTML(value),\n    `\\n    <div>\\\\u003Cmalicious data=\\\\u0022\\\\u0022 \\\\u002F\\\\u003E</div>\\n    null\\n  `\n  );\n  t.end();\n});\ntest('nested sanitization works', async t => {\n  const safe = html`\n    hello\n  `;\n  const value = html`\n    <div>${safe}</div>\n  `;\n  t.equals(typeof value, 'object');\n  // $FlowFixMe\n  t.equals(consumeSanitizedHTML(value), `\\n    <div>\\n    hello\\n  </div>\\n  `);\n  t.end();\n});\ntest('dangerouslySetHTML works', async t => {\n  const trusted = dangerouslySetHTML(JSON.stringify({a: 1}));\n  t.equals(typeof trusted, 'object');\n  // $FlowFixMe\n  t.equals(consumeSanitizedHTML(trusted), `{\"a\":1}`);\n  t.end();\n});\n","// @flow\n\nimport test from 'tape-cup';\nimport ClientAppFactory from '../client-app';\nimport ServerAppFactory from '../server-app';\nimport {run} from './test-helper';\nimport {TimingToken} from '../plugins/timing';\n\nconst App = __BROWSER__ ? ClientAppFactory() : ServerAppFactory();\n\ntest('timing plugin', async t => {\n  const element = 'hi';\n  const renderFn = el => {\n    return el;\n  };\n  const app = new App(element, renderFn);\n  app.middleware({timing: TimingToken}, deps => (ctx, next) => {\n    t.equal(deps.timing.from(ctx), deps.timing.from(ctx), 'timing is memoized');\n    return next();\n  });\n  const ctx = await run(app);\n  t.equal(typeof ctx.timing.start, 'number', 'sets up ctx.timing.start');\n  t.ok(\n    ctx.timing.end instanceof Promise,\n    'sets up ctx.timing.end to be a promise'\n  );\n  ctx.timing.downstream.then(result => {\n    t.equal(typeof result, 'number', 'sets downstream timing result');\n  });\n  ctx.timing.render.then(result => {\n    t.equal(typeof result, 'number', 'sets render timing result');\n  });\n  ctx.timing.upstream.then(result => {\n    t.equal(typeof result, 'number', 'sets upstream timing result');\n  });\n  ctx.timing.end.then(result => {\n    t.equal(typeof result, 'number', 'sets end timing result');\n    t.end();\n  });\n});\n\ntest('timing plugin on error middleware', async t => {\n  const element = 'hi';\n  const renderFn = el => {\n    return el;\n  };\n  const app = new App(element, renderFn);\n  let resolved = {\n    downstream: false,\n    upstream: false,\n    render: false,\n  };\n  app.middleware((ctx, next) => {\n    ctx.timing.downstream.then(result => {\n      resolved.downstream = true;\n    });\n    ctx.timing.render.then(result => {\n      resolved.render = true;\n    });\n    ctx.timing.upstream.then(result => {\n      resolved.upstream = true;\n    });\n    ctx.timing.end.then(result => {\n      t.equal(typeof result, 'number', 'sets end timing result');\n      t.equal(resolved.downstream, false, 'does not resolve downstream');\n      t.equal(resolved.render, false, 'does not resolve render');\n      t.equal(resolved.upstream, false, 'does not resolve upstream');\n      t.equal(ctx.status, 500, 'sets ctx.status');\n      t.end();\n    });\n    return next();\n  });\n  app.middleware((ctx, next) => {\n    const e = new Error('fail request');\n    // $FlowFixMe\n    e.status = 500;\n    throw e;\n  });\n  await run(app).catch(e => {});\n});\n","/** Copyright (c) 2018 Uber Technologies, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * @flow\n */\n\nimport tape from 'tape-cup';\nimport {\n  assetUrl,\n  chunkId,\n  syncChunkIds,\n  syncChunkPaths,\n} from '../virtual/index.js';\n\ntape('virtualModules api', t => {\n  t.equal(typeof assetUrl, 'function');\n  t.equal(typeof chunkId, 'function');\n  t.equal(typeof syncChunkIds, 'function');\n  t.equal(typeof syncChunkPaths, 'function');\n\n  t.equal(assetUrl('0'), '0');\n  t.equal(chunkId('0'), '0');\n  t.equal(syncChunkIds(0), 0);\n  t.equal(syncChunkPaths(0), 0);\n  t.end();\n});\n"],"names":["createPlugin","opts","__plugin__","stack","Error","TokenType","Object","freeze","Required","Optional","Ref","TokenImpl","constructor","name","ref","type","stacks","optional","createToken","RenderToken","ElementToken","SSRDeciderToken","HttpServerToken","SSRBodyTemplateToken","RoutePrefixToken","CriticalChunkIdsToken","html","dangerouslySetHTML","consumeSanitizedHTML","escape","forbiddenChars","replaceForbidden","c","key","Symbol","head","rest","values","obj","defineProperty","enumerable","configurable","value","map","s","i","join","str","String","replace","h","replaceEscaped","fromCodePoint","parseInt","slice","unescape","flowHtml","flowDangerouslySetHTML","flowConsumeSanitizedHTML","flowEscape","botRegex","SSRDecider","provides","ctx","path","match","headers","agent","test","accept","includes","createSSRPlugin","element","ssrDecider","ssrBodyTemplate","ssrPlugin","next","template","htmlAttrs","bodyAttrs","title","body","rendered","respond","legacySSRBodyTemplate","safeAttrs","keys","attrKey","safeBodyAttrs","safeTitle","safeHead","safeBody","preloadHintLinks","getPreloadHintLinks","coreGlobals","getCoreGlobals","chunkScripts","getChunkScripts","bundleSplittingBootstrap","webpackPublicPath","nonce","JSON","stringify","prefix","getUrls","chunkUrlMap","chunks","isCrossOrigin","startsWith","crossOriginAttribute","Set","id","url","get","endsWith","sync","syncChunks","preloaded","preloadChunks","filter","item","hints","FusionApp","el","render","register","tokenOrValue","maybeValue","hasToken","token","renderer","alias","push","_register","registered","Map","enhancerToToken","_dependedOn","plugins","cleanups","aliases","enhancers","getTokenRef","deps","forEach","add","set","sourceToken","destToken","middleware","undefined","enhance","enhancer","Array","isArray","cleanup","Promise","all","fn","resolve","resolved","nonPluginTokens","resolving","resolvedPlugins","appliedEnhancers","resolveToken","tokenAliases","has","newToken","dependents","from","entries","findDependentTokens","entry","findDependentEnhancers","enhancedToken","dependentTokens","base","downstreams","find","t","meta","clue","suggestions","p","help","resolvePlugin","plugin","registeredDeps","resolvedDeps","registeredToken","length","e","nextProvides","delete","_getService","getService","compose","TypeError","context","index","dispatch","reject","err","memoize","memoizeKey","memoized","result","Timing","start","now","deferred","end","downstream","upstream","upstreamStart","timing","TimingToken","promise","then","upstreamTime","endTime","catch","status","seconds","ns","process","hrtime","Math","round","res","rej","getRendererPlugin","timer","renderTime","renderStart","loadEnv","load","env","rootDir","assert","baseAssetPath","cdnUrl","assetPath","envVars","getEnv","uuidv4","useragent","UAParser","getResult","Koa","require","ServerApp","BaseApp","_app","proxy","contextMiddleware","serverRenderer","callback","use","assetUrl","chunkId","filename","syncChunkIds","argument","syncChunkPaths","serverApp","app","App","ok","equal","wrap","toUpperCase","chunkIdZero","equals","ifError","testHelper","tapeFn","testFn","tape","only","bind","skip","getContext","run","assign","ServerAppFactory","firstCleanupCalled","nextCleanupCalled","notOk","A","doesNotThrow","plan","a","number","b","TokenA","TokenB","TokenC","TokenD","TokenEAsNullable","TokenString","TokenNumber","counters","d","PluginA","PluginB","PluginC","PluginD","ValueA","AliasedValue","ValueTokenA","AliasedTokenA","throws","optionalNull","something","checkString","checkNumUndefined","n","numOpt","ParentToken","StringToken","OtherStringToken","fail","TestToken","BrowserPlugin","FnToken","BaseFn","arg","BaseFnEnhancer","DepAToken","DepBToken","DepCToken","DepA","DepB","deepEqual","ROOT_DIR","NODE_ENV","ROUTE_PREFIX","FRAMEWORK_STATIC_ASSET_PATH","CDN_URL","flags","initialCtx","notok","buildApp","SSRDeciderEnhancer","validSSRPathCtx","renderCtx","decide","extensionToSSRSupported","js","gif","jpg","png","pdf","json","shouldSSR","lang","message","mockCtx","counter","counterB","memoizedB","delay","setTimeout","numRenders","renderFn","order","renderPlugin","first","second","third","fourth","called","userData","safe","trusted"],"mappings":"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,CAAW,EAAX,CAAP;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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"}
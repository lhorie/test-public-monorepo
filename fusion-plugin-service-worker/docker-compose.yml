version: '2'
services:
  fusion-plugin-service-worker:
    build: .
    volumes:
      - '.:/fusion-plugin-service-worker'
      - /fusion-plugin-service-worker/node_modules/
      - /fusion-plugin-service-worker/dist/
      - /fusion-plugin-service-worker/dist-tests/
    environment:
      - CODECOV_TOKEN
      - CI=true
      - BUILDKITE
      - BUILDKITE_BRANCH
      - BUILDKITE_BUILD_NUMBER
      - BUILDKITE_JOB_ID
      - BUILDKITE_BUILD_URL
      - BUILDKITE_PROJECT_SLUG
      - BUILDKITE_COMMIT
  fusion-plugin-service-worker-node-last:
    extends: fusion-plugin-service-worker
    build:
      context: .
      args:
        BASE_IMAGE: 'uber/web-base-image:1.0.9'
